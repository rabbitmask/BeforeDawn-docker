import{_ as ee,u as te,r as V,y as N,c as F,z as le,d as v,x as n,f as t,I as ae,G as g,a2 as R,w as l,e as o,i as se,j as r,P as oe,an as ne,p as ie,E as re,h as ue,Z as U,X as de,F as E,D,Y as ce,m as pe,n as y,$ as _e,C as fe,B as me,aC as ve,L as ge,a0 as ye,ag as he,t as p,N as ke,H as be,aB as we,M as Le,au as xe,S as Ve,a6 as ze,v as Ce}from"./index-gZy6T0gL.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css               *//* empty css                *//* empty css                 */import{u as Ee}from"./dict-DPR_BHxq.js";import{c as De}from"./vulnerability-BzfCHx9x.js";import{b as Te}from"./format-BQFyjrq8.js";import"./dict-DLIqIuKu.js";const Se={class:"page-container"},Be={class:"alert-title"},Ie={class:"vuln-icon"},Ne={class:"vuln-title"},Fe={class:"vuln-info"},Re={class:"vuln-desc"},Ue={class:"vuln-meta"},Oe={class:"meta-item"},Pe={class:"meta-item"},$e={class:"card-footer"},je={key:1,class:"pagination-wrapper"},Me={__name:"index",setup(qe){const O=te(),_=Ee(),h=V(!1),P=N(()=>_.getDictData("vuln_type")),$=N(()=>_.getDictData("risk_level")),i=F({keyword:"",vulnType:"",riskLevel:""}),d=F({current:1,size:12}),z=V([]),k=V(0),b=V({critical:0,high:0,medium:0,low:0}),j=s=>_.getDictLabel("vuln_type",s),M=s=>_.getDictLabel("risk_level",s),q=s=>({critical:"#f56c6c",high:"#e6a23c",medium:"#409eff",low:"#67c23a"})[s]||"#909399",A=(s,e)=>s?s.length<=e?s:s.substring(0,e)+"...":"",w=async()=>{h.value=!0;try{const s={current:d.current,size:d.size,...i},e=await De(s);z.value=e.records||[],k.value=e.total||0,G(e.records||[])}catch(s){console.error("加载漏洞案例失败:",s),Ce.error("加载漏洞案例失败")}finally{h.value=!1}},G=s=>{b.value={critical:s.filter(e=>e.riskLevel==="critical").length,high:s.filter(e=>e.riskLevel==="high").length,medium:s.filter(e=>e.riskLevel==="medium").length,low:s.filter(e=>e.riskLevel==="low").length}},f=()=>{d.current=1,w()},H=()=>{Object.assign(i,{keyword:"",vulnType:"",riskLevel:""}),f()},X=s=>{O.push({path:`/vulnerability/detail/${s.id}`,query:{from:"case"}})};return le(async()=>{await _.loadDicts(["vuln_type","risk_level"]),w()}),(s,e)=>{const u=se,Y=ne,Z=ue,L=re,T=ce,S=de,C=pe,J=ie,c=fe,x=ve,m=me,B=ge,I=be,K=Ve,Q=ze,W=ye;return n(),v("div",Se,[t(Y,{type:"info",closable:!1,class:"mb-20"},{title:l(()=>[o("div",Be,[t(u,{size:"18"},{default:l(()=>[t(r(oe))]),_:1}),e[5]||(e[5]=o("span",null,"漏洞案例学习",-1))])]),default:l(()=>[e[6]||(e[6]=o("p",null,"这里展示已修复的真实漏洞案例，供安全研究人员和开发人员学习参考，提升安全意识",-1))]),_:1}),t(c,{shadow:"never",class:"search-card"},{default:l(()=>[t(J,{model:i,inline:""},{default:l(()=>[t(L,{label:"关键词"},{default:l(()=>[t(Z,{modelValue:i.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>i.keyword=a),placeholder:"漏洞标题",clearable:"",style:{width:"250px"},onClear:f},{prefix:l(()=>[t(u,null,{default:l(()=>[t(r(U))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"漏洞类型"},{default:l(()=>[t(S,{modelValue:i.vulnType,"onUpdate:modelValue":e[1]||(e[1]=a=>i.vulnType=a),placeholder:"请选择",clearable:"",style:{width:"150px"},onChange:f},{default:l(()=>[(n(!0),v(E,null,D(P.value,a=>(n(),g(T,{key:a.dictValue,label:a.dictLabel,value:a.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"风险等级"},{default:l(()=>[t(S,{modelValue:i.riskLevel,"onUpdate:modelValue":e[2]||(e[2]=a=>i.riskLevel=a),placeholder:"请选择",clearable:"",style:{width:"120px"},onChange:f},{default:l(()=>[(n(!0),v(E,null,D($.value,a=>(n(),g(T,{key:a.dictValue,label:a.dictLabel,value:a.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(L,null,{default:l(()=>[t(C,{type:"primary",onClick:f},{default:l(()=>[t(u,null,{default:l(()=>[t(r(U))]),_:1}),e[7]||(e[7]=y(" 搜索 ",-1))]),_:1}),t(C,{onClick:H},{default:l(()=>[t(u,null,{default:l(()=>[t(r(_e))]),_:1}),e[8]||(e[8]=y(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(B,{gutter:20,class:"stats-row"},{default:l(()=>[t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card"},{default:l(()=>[t(x,{title:"漏洞总数",value:k.value},{suffix:l(()=>[...e[9]||(e[9]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card stat-critical"},{default:l(()=>[t(x,{title:"严重漏洞",value:b.value.critical||0},{suffix:l(()=>[...e[10]||(e[10]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card stat-high"},{default:l(()=>[t(x,{title:"高危漏洞",value:b.value.high||0},{suffix:l(()=>[...e[11]||(e[11]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card stat-medium"},{default:l(()=>[t(x,{title:"中危漏洞",value:b.value.medium||0},{suffix:l(()=>[...e[12]||(e[12]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),ae((n(),g(B,{gutter:20},{default:l(()=>[(n(!0),v(E,null,D(z.value,a=>(n(),g(m,{key:a.id,xs:24,sm:12,md:8,lg:6},{default:l(()=>[t(c,{shadow:"hover",class:"vuln-card",onClick:Ae=>X(a)},{default:l(()=>[o("div",{class:he(["risk-badge",`risk-${a.riskLevel}`])},p(M(a.riskLevel)),3),o("div",Ie,[t(u,{size:48,color:q(a.riskLevel)},{default:l(()=>[t(r(ke))]),_:1},8,["color"])]),o("h3",Ne,p(a.title),1),o("div",Fe,[t(I,{type:"info",size:"small"},{default:l(()=>[y(p(j(a.vulnType)),1)]),_:2},1024),t(I,{type:"success",size:"small",class:"ml-10"},{default:l(()=>[...e[13]||(e[13]=[y("已修复",-1)])]),_:1})]),o("div",Re,p(A(a.description,80)),1),o("div",Ue,[o("div",Oe,[t(u,null,{default:l(()=>[t(r(we))]),_:1}),o("span",null,p(r(Te)(a.closeTime)),1)]),o("div",Pe,[t(u,null,{default:l(()=>[t(r(Le))]),_:1}),o("span",null,p(a.assetName),1)])]),o("div",$e,[t(C,{type:"primary",size:"small",style:{width:"100%"}},{default:l(()=>[t(u,null,{default:l(()=>[t(r(xe))]),_:1}),e[14]||(e[14]=y(" 查看详情 ",-1))]),_:1})])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),[[W,h.value]]),!h.value&&z.value.length===0?(n(),g(K,{key:0,description:"暂无漏洞案例","image-size":200})):R("",!0),k.value>0?(n(),v("div",je,[t(Q,{"current-page":d.current,"onUpdate:currentPage":e[3]||(e[3]=a=>d.current=a),"page-size":d.size,"onUpdate:pageSize":e[4]||(e[4]=a=>d.size=a),total:k.value,"page-sizes":[12,24,48,96],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:w,onCurrentChange:w},null,8,["current-page","page-size","total"])])):R("",!0)])}}},st=ee(Me,[["__scopeId","data-v-90e58cbb"]]);export{st as default};
