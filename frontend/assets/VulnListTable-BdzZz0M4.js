import{_ as I,u as N,b as R,z as q,d as F,x as u,I as j,a0 as A,G as m,w as s,f as e,a1 as G,H,n,t as f,j as i,a2 as v,m as M,i as O,au as U,a3 as J,av as K,O as Q,a4 as W,P as X,a5 as Y}from"./index-gZy6T0gL.js";/* empty css                   *//* empty css                        *//* empty css               */import{u as Z}from"./dict-DPR_BHxq.js";import{f as ee}from"./format-BQFyjrq8.js";const te={class:"vuln-list-table"},le={__name:"VulnListTable",props:{data:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["view","edit","fix","retest","delete","toggle-public"],setup(b,{emit:y}){const d=y;N();const r=R(),g=Z();q(async()=>{await g.loadDicts(["vuln_type","risk_level","vuln_status"])});const h=t=>g.getDictLabel("vuln_type",t),C=t=>g.getDictLabel("risk_level",t),w=t=>({critical:"danger",high:"danger",medium:"warning",low:"info"})[t]||"",L=t=>g.getDictLabel("vuln_status",t),x=t=>({assigned:"warning",fixed:"primary",closed:"success"})[t]||"",T=t=>{var a;return t.assigneeId===((a=r.userInfo)==null?void 0:a.id)},z=t=>{d("view",t)},D=t=>{d("edit",t)},P=t=>{d("fix",t)},V=t=>{d("retest",t)},E=t=>{d("delete",t)},S=t=>{d("toggle-public",t)};return(t,a)=>{const o=G,k=H,c=O,p=M,$=Y,B=A;return u(),F("div",te,[j((u(),m($,{data:b.data,stripe:"",style:{width:"100%"}},{default:s(()=>[e(o,{prop:"vulnCode",label:"漏洞编号",width:"220"}),e(o,{prop:"title",label:"漏洞标题","min-width":"200","show-overflow-tooltip":""}),e(o,{prop:"vulnType",label:"类型",width:"120"},{default:s(({row:l})=>[e(k,{type:"info",size:"small"},{default:s(()=>[n(f(h(l.vulnType)),1)]),_:2},1024)]),_:1}),e(o,{prop:"riskLevel",label:"风险等级",width:"100"},{default:s(({row:l})=>[e(k,{type:w(l.riskLevel),size:"small"},{default:s(()=>[n(f(C(l.riskLevel)),1)]),_:2},1032,["type"])]),_:1}),e(o,{prop:"status",label:"状态",width:"120"},{default:s(({row:l})=>[e(k,{type:x(l.status),size:"small"},{default:s(()=>[n(f(L(l.status)),1)]),_:2},1032,["type"])]),_:1}),e(o,{prop:"assetName",label:"关联资产",width:"150","show-overflow-tooltip":""}),e(o,{prop:"assigneeName",label:"分配给",width:"100"}),e(o,{prop:"submitTime",label:"提交时间",width:"160"},{default:s(({row:l})=>[n(f(i(ee)(l.submitTime)),1)]),_:1}),e(o,{label:"操作",width:"280",fixed:"right"},{default:s(({row:l})=>[e(p,{link:"",type:"primary",size:"small",onClick:_=>z(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(i(U))]),_:1}),a[0]||(a[0]=n(" 查看 ",-1))]),_:1},8,["onClick"]),i(r).hasPermission("vuln:edit")&&l.status!=="closed"?(u(),m(p,{key:0,link:"",type:"warning",size:"small",onClick:_=>D(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(i(J))]),_:1}),a[1]||(a[1]=n(" 编辑 ",-1))]),_:1},8,["onClick"])):v("",!0),l.status==="assigned"&&T(l)?(u(),m(p,{key:1,link:"",type:"success",size:"small",onClick:_=>P(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(i(K))]),_:1}),a[2]||(a[2]=n(" 修复 ",-1))]),_:1},8,["onClick"])):v("",!0),l.status==="fixed"&&i(r).hasPermission("vuln:retest")?(u(),m(p,{key:2,link:"",type:"warning",size:"small",onClick:_=>V(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(i(Q))]),_:1}),a[3]||(a[3]=n(" 复测 ",-1))]),_:1},8,["onClick"])):v("",!0),i(r).hasPermission("vuln:delete")?(u(),m(p,{key:3,link:"",type:"danger",size:"small",onClick:_=>E(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(i(W))]),_:1}),a[4]||(a[4]=n(" 删除 ",-1))]),_:1},8,["onClick"])):v("",!0),l.status==="closed"&&(i(r).hasPermission("vuln:edit")||i(r).hasPermission("vuln:query:all"))?(u(),m(p,{key:4,link:"",type:l.isPublic===1?"warning":"success",size:"small",onClick:_=>S(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(i(X))]),_:1}),n(" "+f(l.isPublic===1?"取消公开":"公开"),1)]),_:2},1032,["type","onClick"])):v("",!0)]),_:1})]),_:1},8,["data"])),[[B,b.loading]])])}}},de=I(le,[["__scopeId","data-v-881b22c8"]]);export{de as V};
