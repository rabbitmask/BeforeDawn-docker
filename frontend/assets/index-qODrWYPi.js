import{_ as ee,h as te,aG as le,r as V,y as O,a as B,z as ae,c as v,o as n,d as t,J as se,H as g,a4 as F,w as l,b as o,l as oe,m as r,Q as ne,ay as ie,E as re,j as ue,k as de,a0 as R,Z as ce,F as C,G as D,$ as _e,q as pe,s as y,a1 as fe,D as me,C as ve,aP as ge,M as ye,a2 as he,ai as ke,t as _,O as be,I as we,aO as Le,N as xe,aw as Ve,S as ze,a8 as Ee,x as Ce}from"./index-P-kv1zA8.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css               *//* empty css                *//* empty css                 */import{c as De}from"./vulnerability-DkKcdRS0.js";import{b as Te}from"./format-BQFyjrq8.js";const Se={class:"page-container"},Ie={class:"alert-title"},Ne={class:"vuln-icon"},Oe={class:"vuln-title"},Be={class:"vuln-info"},Fe={class:"vuln-desc"},Re={class:"vuln-meta"},Ue={class:"meta-item"},Pe={class:"meta-item"},$e={class:"card-footer"},je={key:1,class:"pagination-wrapper"},Me={__name:"index",setup(qe){const U=te(),p=le(),h=V(!1),P=O(()=>p.getDictData("vuln_type")),$=O(()=>p.getDictData("risk_level")),i=B({keyword:"",vulnType:"",riskLevel:""}),d=B({current:1,size:12}),z=V([]),k=V(0),b=V({critical:0,high:0,medium:0,low:0}),j=s=>p.getDictLabel("vuln_type",s),M=s=>p.getDictLabel("risk_level",s),q=s=>({critical:"#f56c6c",high:"#e6a23c",medium:"#409eff",low:"#67c23a"})[s]||"#909399",G=(s,e)=>s?s.length<=e?s:s.substring(0,e)+"...":"",w=async()=>{h.value=!0;try{const s={current:d.current,size:d.size,...i},e=await De(s);z.value=e.records||[],k.value=e.total||0,A(e.records||[])}catch(s){console.error("加载漏洞案例失败:",s),Ce.error("加载漏洞案例失败")}finally{h.value=!1}},A=s=>{b.value={critical:s.filter(e=>e.riskLevel==="critical").length,high:s.filter(e=>e.riskLevel==="high").length,medium:s.filter(e=>e.riskLevel==="medium").length,low:s.filter(e=>e.riskLevel==="low").length}},f=()=>{d.current=1,w()},H=()=>{Object.assign(i,{keyword:"",vulnType:"",riskLevel:""}),f()},J=s=>{U.push({path:`/vulnerability/detail/${s.id}`,query:{from:"case"}})};return ae(async()=>{await p.loadDicts(["vuln_type","risk_level"]),w()}),(s,e)=>{const u=oe,Q=ie,Z=de,L=ue,T=_e,S=ce,E=pe,K=re,c=me,x=ge,m=ve,I=ye,N=we,W=ze,X=Ee,Y=he;return n(),v("div",Se,[t(Q,{type:"info",closable:!1,class:"mb-20"},{title:l(()=>[o("div",Ie,[t(u,{size:"18"},{default:l(()=>[t(r(ne))]),_:1}),e[5]||(e[5]=o("span",null,"漏洞案例学习",-1))])]),default:l(()=>[e[6]||(e[6]=o("p",null,"这里展示已修复的真实漏洞案例，供安全研究人员和开发人员学习参考，提升安全意识",-1))]),_:1}),t(c,{shadow:"never",class:"search-card"},{default:l(()=>[t(K,{model:i,inline:""},{default:l(()=>[t(L,{label:"关键词"},{default:l(()=>[t(Z,{modelValue:i.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>i.keyword=a),placeholder:"漏洞标题",clearable:"",style:{width:"250px"},onClear:f},{prefix:l(()=>[t(u,null,{default:l(()=>[t(r(R))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"漏洞类型"},{default:l(()=>[t(S,{modelValue:i.vulnType,"onUpdate:modelValue":e[1]||(e[1]=a=>i.vulnType=a),placeholder:"请选择",clearable:"",style:{width:"150px"},onChange:f},{default:l(()=>[(n(!0),v(C,null,D(P.value,a=>(n(),g(T,{key:a.dictValue,label:a.dictLabel,value:a.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"风险等级"},{default:l(()=>[t(S,{modelValue:i.riskLevel,"onUpdate:modelValue":e[2]||(e[2]=a=>i.riskLevel=a),placeholder:"请选择",clearable:"",style:{width:"120px"},onChange:f},{default:l(()=>[(n(!0),v(C,null,D($.value,a=>(n(),g(T,{key:a.dictValue,label:a.dictLabel,value:a.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(L,null,{default:l(()=>[t(E,{type:"primary",onClick:f},{default:l(()=>[t(u,null,{default:l(()=>[t(r(R))]),_:1}),e[7]||(e[7]=y(" 搜索 ",-1))]),_:1}),t(E,{onClick:H},{default:l(()=>[t(u,null,{default:l(()=>[t(r(fe))]),_:1}),e[8]||(e[8]=y(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(I,{gutter:20,class:"stats-row"},{default:l(()=>[t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card"},{default:l(()=>[t(x,{title:"漏洞总数",value:k.value},{suffix:l(()=>[...e[9]||(e[9]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card stat-critical"},{default:l(()=>[t(x,{title:"严重漏洞",value:b.value.critical||0},{suffix:l(()=>[...e[10]||(e[10]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card stat-high"},{default:l(()=>[t(x,{title:"高危漏洞",value:b.value.high||0},{suffix:l(()=>[...e[11]||(e[11]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card stat-medium"},{default:l(()=>[t(x,{title:"中危漏洞",value:b.value.medium||0},{suffix:l(()=>[...e[12]||(e[12]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),se((n(),g(I,{gutter:20},{default:l(()=>[(n(!0),v(C,null,D(z.value,a=>(n(),g(m,{key:a.id,xs:24,sm:12,md:8,lg:6},{default:l(()=>[t(c,{shadow:"hover",class:"vuln-card",onClick:Ge=>J(a)},{default:l(()=>[o("div",{class:ke(["risk-badge",`risk-${a.riskLevel}`])},_(M(a.riskLevel)),3),o("div",Ne,[t(u,{size:48,color:q(a.riskLevel)},{default:l(()=>[t(r(be))]),_:1},8,["color"])]),o("h3",Oe,_(a.title),1),o("div",Be,[t(N,{type:"info",size:"small"},{default:l(()=>[y(_(j(a.vulnType)),1)]),_:2},1024),t(N,{type:"success",size:"small",class:"ml-10"},{default:l(()=>[...e[13]||(e[13]=[y("已修复",-1)])]),_:1})]),o("div",Fe,_(G(a.description,80)),1),o("div",Re,[o("div",Ue,[t(u,null,{default:l(()=>[t(r(Le))]),_:1}),o("span",null,_(r(Te)(a.closeTime)),1)]),o("div",Pe,[t(u,null,{default:l(()=>[t(r(xe))]),_:1}),o("span",null,_(a.assetName),1)])]),o("div",$e,[t(E,{type:"primary",size:"small",style:{width:"100%"}},{default:l(()=>[t(u,null,{default:l(()=>[t(r(Ve))]),_:1}),e[14]||(e[14]=y(" 查看详情 ",-1))]),_:1})])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),[[Y,h.value]]),!h.value&&z.value.length===0?(n(),g(W,{key:0,description:"暂无漏洞案例","image-size":200})):F("",!0),k.value>0?(n(),v("div",je,[t(X,{"current-page":d.current,"onUpdate:currentPage":e[3]||(e[3]=a=>d.current=a),"page-size":d.size,"onUpdate:pageSize":e[4]||(e[4]=a=>d.size=a),total:k.value,"page-sizes":[12,24,48,96],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:w,onCurrentChange:w},null,8,["current-page","page-size","total"])])):F("",!0)])}}},lt=ee(Me,[["__scopeId","data-v-90e58cbb"]]);export{lt as default};
