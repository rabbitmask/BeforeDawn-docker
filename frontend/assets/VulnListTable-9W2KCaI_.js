import{_ as B,f as I,u as R,q,t as A,c as F,o as u,G,a0 as H,C as m,w as s,e,a1 as M,D as O,n as i,z as f,A as n,a2 as g,m as Q,H as U,aG as j,a3 as J,aQ as K,N as W,a5 as X,O as Y,a6 as Z}from"./index-D-KiCPd7.js";/* empty css                   *//* empty css                        *//* empty css               */import{f as ee}from"./format-BQFyjrq8.js";const te={class:"vuln-list-table"},le={__name:"VulnListTable",props:{data:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["view","edit","fix","retest","delete","toggle-public"],setup(b,{emit:y}){const d=y;I();const r=R(),v=q();A(async()=>{await v.loadDicts(["vuln_type","risk_level","vuln_status"])});const h=t=>v.getDictLabel("vuln_type",t),C=t=>v.getDictLabel("risk_level",t),w=t=>({critical:"danger",high:"danger",medium:"warning",low:"info"})[t]||"",L=t=>v.getDictLabel("vuln_status",t),T=t=>({assigned:"warning",fixed:"primary",closed:"success"})[t]||"",x=t=>{var a;return t.assigneeId===((a=r.userInfo)==null?void 0:a.id)},z=t=>{d("view",t)},D=t=>{d("edit",t)},P=t=>{d("fix",t)},V=t=>{d("retest",t)},E=t=>{d("delete",t)},S=t=>{d("toggle-public",t)};return(t,a)=>{const o=M,k=O,c=U,p=Q,N=Z,$=H;return u(),F("div",te,[G((u(),m(N,{data:b.data,stripe:"",style:{width:"100%"}},{default:s(()=>[e(o,{prop:"vulnCode",label:"漏洞编号",width:"220"}),e(o,{prop:"title",label:"漏洞标题","min-width":"200","show-overflow-tooltip":""}),e(o,{prop:"vulnType",label:"类型",width:"120"},{default:s(({row:l})=>[e(k,{type:"info",size:"small"},{default:s(()=>[i(f(h(l.vulnType)),1)]),_:2},1024)]),_:1}),e(o,{prop:"riskLevel",label:"风险等级",width:"100"},{default:s(({row:l})=>[e(k,{type:w(l.riskLevel),size:"small"},{default:s(()=>[i(f(C(l.riskLevel)),1)]),_:2},1032,["type"])]),_:1}),e(o,{prop:"status",label:"状态",width:"120"},{default:s(({row:l})=>[e(k,{type:T(l.status),size:"small"},{default:s(()=>[i(f(L(l.status)),1)]),_:2},1032,["type"])]),_:1}),e(o,{prop:"assetName",label:"关联资产",width:"150","show-overflow-tooltip":""}),e(o,{prop:"assigneeName",label:"分配给",width:"100"}),e(o,{prop:"submitTime",label:"提交时间",width:"160"},{default:s(({row:l})=>[i(f(n(ee)(l.submitTime)),1)]),_:1}),e(o,{label:"操作",width:"280",fixed:"right"},{default:s(({row:l})=>[e(p,{link:"",type:"primary",size:"small",onClick:_=>z(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(n(j))]),_:1}),a[0]||(a[0]=i(" 查看 ",-1))]),_:1},8,["onClick"]),n(r).hasPermission("vuln:edit")&&l.status!=="closed"?(u(),m(p,{key:0,link:"",type:"warning",size:"small",onClick:_=>D(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(n(J))]),_:1}),a[1]||(a[1]=i(" 编辑 ",-1))]),_:1},8,["onClick"])):g("",!0),l.status==="assigned"&&x(l)?(u(),m(p,{key:1,link:"",type:"success",size:"small",onClick:_=>P(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(n(K))]),_:1}),a[2]||(a[2]=i(" 修复 ",-1))]),_:1},8,["onClick"])):g("",!0),l.status==="fixed"&&n(r).hasPermission("vuln:retest")?(u(),m(p,{key:2,link:"",type:"warning",size:"small",onClick:_=>V(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(n(W))]),_:1}),a[3]||(a[3]=i(" 复测 ",-1))]),_:1},8,["onClick"])):g("",!0),n(r).hasPermission("vuln:delete")?(u(),m(p,{key:3,link:"",type:"danger",size:"small",onClick:_=>E(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(n(X))]),_:1}),a[4]||(a[4]=i(" 删除 ",-1))]),_:1},8,["onClick"])):g("",!0),l.status==="closed"&&(n(r).hasPermission("vuln:edit")||n(r).hasPermission("vuln:query:all"))?(u(),m(p,{key:4,link:"",type:l.isPublic===1?"warning":"success",size:"small",onClick:_=>S(l)},{default:s(()=>[e(c,null,{default:s(()=>[e(n(Y))]),_:1}),i(" "+f(l.isPublic===1?"取消公开":"公开"),1)]),_:2},1032,["type","onClick"])):g("",!0)]),_:1})]),_:1},8,["data"])),[[$,b.loading]])])}}},ue=B(le,[["__scopeId","data-v-881b22c8"]]);export{ue as V};
