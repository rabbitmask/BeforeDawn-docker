import{_ as j,u as G,b as J,y as I,c as B,r as L,z as K,A as O,d as f,x as c,f as t,w as e,B as Q,C as W,e as s,t as l,j as r,F as N,D as P,G as v,H as X,n as p,I as Y,m as Z,i as ss,J as ts,K as es,L as os,M as as,N as ls,O as ns,P as is,Q as R,R as rs,q as ds,S as cs,T as us,U as _s,V as ms,W as fs,v as vs}from"./index-DNLodC6g.js";/* empty css                         *//* empty css                    *//* empty css               *//* empty css                *//* empty css               */import{g as ps}from"./statistics-DRtSdn0o.js";import{f as gs}from"./index-uw5tQqLt.js";const hs={class:"dashboard-container"},ks={class:"welcome-content"},Cs={class:"welcome-left"},bs={class:"user-tags"},ys={class:"welcome-right"},xs={class:"stat-icon",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}},ws={class:"stat-content"},zs={class:"stat-value"},Ns={class:"stat-icon",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"}},Ps={class:"stat-content"},Es={class:"stat-value"},Ds={class:"stat-icon",style:{background:"linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)"}},Ss={class:"stat-content"},Ts={class:"stat-value"},Is={class:"stat-icon",style:{background:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"}},Bs={class:"stat-content"},Ls={class:"stat-value"},Rs={class:"card-header"},As={class:"risk-distribution"},Ms={class:"risk-item"},Vs={class:"risk-info"},$s={class:"risk-value"},qs={class:"risk-item"},Fs={class:"risk-info"},Hs={class:"risk-value"},Us={class:"risk-item"},js={class:"risk-info"},Gs={class:"risk-value"},Js={class:"card-header"},Ks={class:"fix-progress"},Os={class:"progress-circle"},Qs={class:"percentage-value"},Ws={class:"progress-stats"},Xs={class:"progress-item"},Ys={class:"value"},Zs={class:"progress-item"},st={class:"value success"},tt={class:"progress-item"},et={class:"value danger"},ot={class:"card-header"},at={class:"todo-list"},lt={key:1,class:"todo-items"},nt=["onClick"],it={class:"todo-left"},rt={class:"todo-title"},dt={class:"todo-right"},ct={class:"todo-time"},ut={class:"activity-list"},_t=["onClick"],mt={class:"activity-action"},ft={class:"activity-target"},vt={__name:"index",setup(pt){const g=G(),h=J(),A=I(()=>{const a=new Date().getHours();return a<6?"凌晨好":a<9?"早上好":a<12?"上午好":a<14?"中午好":a<18?"下午好":a<22?"晚上好":"夜深了"}),n=B({assetCount:0,vulnCount:0,fixedCount:0,articleCount:0}),d=B({critical:0,high:0,medium:0,criticalPercent:0,highPercent:0,mediumPercent:0}),E=I(()=>n.vulnCount===0?0:Math.round(n.fixedCount/n.vulnCount*100)),k=L([]),z=L([]);async function M(){try{console.log("开始加载Dashboard数据...");const a=await ps();console.log("Dashboard API返回:",a),a?(console.log("原始数据:",{assetCount:a.assetCount,vulnCount:a.vulnCount,fixedCount:a.fixedCount,articleCount:a.articleCount}),n.assetCount=Number(a.assetCount)||0,n.vulnCount=Number(a.vulnCount)||0,n.fixedCount=Number(a.fixedCount)||0,n.articleCount=Number(a.articleCount)||0,console.log("转换后的stats:",{assetCount:n.assetCount,vulnCount:n.vulnCount,fixedCount:n.fixedCount,articleCount:n.articleCount}),a.riskStats&&(d.critical=Number(a.riskStats.critical)||0,d.high=Number(a.riskStats.high)||0,d.medium=Number(a.riskStats.medium)||0,d.criticalPercent=Number(a.riskStats.criticalPercent)||0,d.highPercent=Number(a.riskStats.highPercent)||0,d.mediumPercent=Number(a.riskStats.mediumPercent)||0,console.log("风险统计:",d)),k.value=a.todoList||[],z.value=a.activityList||[],console.log("Dashboard数据加载成功")):console.warn("Dashboard返回数据格式不正确:",a)}catch(a){console.error("加载Dashboard数据失败:",a),vs.error("加载数据失败")}}const D=a=>{g.push(a)},V=()=>{g.push("/vulnerability/mytodo")},$=a=>{a.type==="vuln_case"?g.push("/knowledge/case"):a.type==="article"?g.push("/knowledge/article"):g.push("/knowledge")};return K(()=>{var a;console.log("首页加载完成，用户:",(a=h.userInfo)==null?void 0:a.username),M()}),(a,o)=>{const C=X,u=ss,S=Z,_=W,m=Q,b=os,y=rs,q=_s,T=cs,F=fs,H=ms,U=O("permission");return c(),f("div",hs,[t(b,{gutter:20},{default:e(()=>[t(m,{span:24},{default:e(()=>[t(_,{class:"welcome-card"},{default:e(()=>{var i,x;return[s("div",ks,[s("div",Cs,[s("h2",null,l(A.value)+"，"+l(((i=r(h).userInfo)==null?void 0:i.realName)||((x=r(h).userInfo)==null?void 0:x.username)||"朋友")+"！",1),s("div",bs,[(c(!0),f(N,null,P(r(h).roles,w=>(c(),v(C,{key:w,type:"primary",effect:"dark"},{default:e(()=>[p(l(w),1)]),_:2},1024))),128))]),o[2]||(o[2]=s("p",{class:"welcome-desc"},"今天也要努力搞安全啊！",-1))]),s("div",ys,[Y((c(),v(S,{type:"primary",size:"large",onClick:o[0]||(o[0]=w=>D("/vulnerability/submit"))},{default:e(()=>[t(u,null,{default:e(()=>[t(r(ts))]),_:1}),o[3]||(o[3]=p(" 提交漏洞 ",-1))]),_:1})),[[U,"vuln:submit:add"]]),t(S,{type:"success",size:"large",onClick:o[1]||(o[1]=w=>D("/vulnerability/mytodo"))},{default:e(()=>[t(u,null,{default:e(()=>[t(r(es))]),_:1}),o[4]||(o[4]=p(" 我的待办 ",-1))]),_:1})])])]}),_:1})]),_:1})]),_:1}),t(b,{gutter:20,class:"mt-20"},{default:e(()=>[t(m,{xs:24,sm:12,md:6},{default:e(()=>[t(_,{class:"stat-card",shadow:"hover"},{default:e(()=>[s("div",xs,[t(u,{size:32},{default:e(()=>[t(r(as))]),_:1})]),s("div",ws,[s("div",zs,l(n.assetCount),1),o[5]||(o[5]=s("div",{class:"stat-label"},"资产总数",-1))])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:6},{default:e(()=>[t(_,{class:"stat-card",shadow:"hover"},{default:e(()=>[s("div",Ns,[t(u,{size:32},{default:e(()=>[t(r(ls))]),_:1})]),s("div",Ps,[s("div",Es,l(n.vulnCount),1),o[6]||(o[6]=s("div",{class:"stat-label"},"漏洞总数",-1))])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:6},{default:e(()=>[t(_,{class:"stat-card",shadow:"hover"},{default:e(()=>[s("div",Ds,[t(u,{size:32},{default:e(()=>[t(r(ns))]),_:1})]),s("div",Ss,[s("div",Ts,l(n.fixedCount),1),o[7]||(o[7]=s("div",{class:"stat-label"},"已修复",-1))])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:6},{default:e(()=>[t(_,{class:"stat-card",shadow:"hover"},{default:e(()=>[s("div",Is,[t(u,{size:32},{default:e(()=>[t(r(is))]),_:1})]),s("div",Bs,[s("div",Ls,l(n.articleCount),1),o[8]||(o[8]=s("div",{class:"stat-label"},"知识库文章",-1))])]),_:1})]),_:1})]),_:1}),t(b,{gutter:20,class:"mt-20"},{default:e(()=>[t(m,{xs:24,md:12},{default:e(()=>[t(_,null,{header:e(()=>[s("div",Rs,[o[10]||(o[10]=s("span",null,"漏洞风险分布",-1)),t(C,{type:"danger",size:"small"},{default:e(()=>[...o[9]||(o[9]=[p("实时",-1)])]),_:1})])]),default:e(()=>[s("div",As,[s("div",Ms,[s("div",Vs,[t(u,{size:24,color:"#f56c6c"},{default:e(()=>[t(r(R))]),_:1}),o[11]||(o[11]=s("span",{class:"risk-label"},"高危漏洞",-1))]),s("div",$s,l(d.critical),1),t(y,{percentage:d.criticalPercent,color:"#f56c6c","stroke-width":12},null,8,["percentage"])]),s("div",qs,[s("div",Fs,[t(u,{size:24,color:"#e6a23c"},{default:e(()=>[t(r(R))]),_:1}),o[12]||(o[12]=s("span",{class:"risk-label"},"中危漏洞",-1))]),s("div",Hs,l(d.high),1),t(y,{percentage:d.highPercent,color:"#e6a23c","stroke-width":12},null,8,["percentage"])]),s("div",Us,[s("div",js,[t(u,{size:24,color:"#409eff"},{default:e(()=>[t(r(ds))]),_:1}),o[13]||(o[13]=s("span",{class:"risk-label"},"低危漏洞",-1))]),s("div",Gs,l(d.medium),1),t(y,{percentage:d.mediumPercent,color:"#409eff","stroke-width":12},null,8,["percentage"])])])]),_:1})]),_:1}),t(m,{xs:24,md:12},{default:e(()=>[t(_,null,{header:e(()=>[s("div",Js,[o[14]||(o[14]=s("span",null,"修复进度",-1)),t(C,{type:"success",size:"small"},{default:e(()=>[p(l(E.value)+"%",1)]),_:1})])]),default:e(()=>[s("div",Ks,[s("div",Os,[t(y,{type:"circle",percentage:E.value,width:150,"stroke-width":12},{default:e(({percentage:i})=>[s("span",Qs,l(i)+"%",1),o[15]||(o[15]=s("span",{class:"percentage-label"},"修复率",-1))]),_:1},8,["percentage"])]),s("div",Ws,[s("div",Xs,[o[16]||(o[16]=s("span",{class:"label"},"总计漏洞",-1)),s("span",Ys,l(n.vulnCount),1)]),s("div",Zs,[o[17]||(o[17]=s("span",{class:"label"},"已修复",-1)),s("span",st,l(n.fixedCount),1)]),s("div",tt,[o[18]||(o[18]=s("span",{class:"label"},"待修复",-1)),s("span",et,l(n.vulnCount-n.fixedCount),1)])])])]),_:1})]),_:1})]),_:1}),t(b,{gutter:20,class:"mt-20"},{default:e(()=>[t(m,{xs:24,md:12},{default:e(()=>[t(_,null,{header:e(()=>[s("div",ot,[o[19]||(o[19]=s("span",null,"我的待办",-1)),t(q,{value:k.value.length,type:"danger"},null,8,["value"])])]),default:e(()=>[s("div",at,[k.value.length===0?(c(),v(T,{key:0,description:"暂无待办事项","image-size":100})):(c(),f("div",lt,[(c(!0),f(N,null,P(k.value,i=>(c(),f("div",{key:i.id,class:"todo-item",onClick:x=>V(i)},[s("div",it,[t(C,{type:i.levelType,size:"small"},{default:e(()=>[p(l(i.level),1)]),_:2},1032,["type"]),s("span",rt,l(i.title),1)]),s("div",dt,[s("span",ct,l(i.time),1),t(u,null,{default:e(()=>[t(r(us))]),_:1})])],8,nt))),128))]))])]),_:1})]),_:1}),t(m,{xs:24,md:12},{default:e(()=>[t(_,null,{header:e(()=>[...o[20]||(o[20]=[s("div",{class:"card-header"},[s("span",null,"最新动态")],-1)])]),default:e(()=>[s("div",ut,[z.value.length===0?(c(),v(T,{key:0,description:"暂无最新动态","image-size":100})):(c(),v(H,{key:1},{default:e(()=>[(c(!0),f(N,null,P(z.value,i=>(c(),v(F,{key:i.id,timestamp:r(gs)(i.time),color:i.color},{default:e(()=>[s("div",{class:"activity-content",onClick:x=>$(i)},[s("span",mt,"【"+l(i.action)+"】",1),s("span",ft,l(i.target),1)],8,_t)]),_:2},1032,["timestamp","color"]))),128))]),_:1}))])]),_:1})]),_:1})]),_:1})])}}},zt=j(vt,[["__scopeId","data-v-a4b7908f"]]);export{zt as default};
