import{_ as ee,f as te,q as le,r as x,s as F,a as N,t as ae,c as v,o as n,e as t,G as se,C as g,a2 as O,w as l,b as o,H as oe,A as r,O as ne,aI as ie,h as re,j as ue,k as de,Z as R,X as ce,F as C,B as D,Y as pe,m as _e,n as y,$ as fe,E as me,y as ve,aY as ge,K as ye,a0 as he,ah as ke,z as p,M as we,D as be,aX as Le,L as Ve,aG as xe,Q as ze,a7 as Ee,p as Ce}from"./index-DG9m7imz.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css               *//* empty css                *//* empty css                 */import{c as De}from"./vulnerability-BPpAdgVn.js";import{b as Te}from"./format-BQFyjrq8.js";const Se={class:"page-container"},Be={class:"alert-title"},Ie={class:"vuln-icon"},Fe={class:"vuln-title"},Ne={class:"vuln-info"},Oe={class:"vuln-desc"},Re={class:"vuln-meta"},Ue={class:"meta-item"},$e={class:"meta-item"},je={class:"card-footer"},Me={key:1,class:"pagination-wrapper"},Pe={__name:"index",setup(qe){const U=te(),_=le(),h=x(!1),$=F(()=>_.getDictData("vuln_type")),j=F(()=>_.getDictData("risk_level")),i=N({keyword:"",vulnType:"",riskLevel:""}),d=N({current:1,size:12}),z=x([]),k=x(0),w=x({critical:0,high:0,medium:0,low:0}),M=s=>_.getDictLabel("vuln_type",s),P=s=>_.getDictLabel("risk_level",s),q=s=>({critical:"#f56c6c",high:"#e6a23c",medium:"#1d4ed8",low:"#67c23a"})[s]||"#909399",A=(s,e)=>s?s.length<=e?s:s.substring(0,e)+"...":"",b=async()=>{h.value=!0;try{const s={current:d.current,size:d.size,...i},e=await De(s);z.value=e.records||[],k.value=e.total||0,G(e.records||[])}catch(s){console.error("加载漏洞案例失败:",s),Ce.error("加载漏洞案例失败")}finally{h.value=!1}},G=s=>{w.value={critical:s.filter(e=>e.riskLevel==="critical").length,high:s.filter(e=>e.riskLevel==="high").length,medium:s.filter(e=>e.riskLevel==="medium").length,low:s.filter(e=>e.riskLevel==="low").length}},f=()=>{d.current=1,b()},X=()=>{Object.assign(i,{keyword:"",vulnType:"",riskLevel:""}),f()},Y=s=>{U.push({path:`/vulnerability/detail/${s.id}`,query:{from:"case"}})};return ae(async()=>{await _.loadDicts(["vuln_type","risk_level"]),b()}),(s,e)=>{const u=oe,H=ie,K=de,L=ue,T=pe,S=ce,E=_e,Q=re,c=me,V=ge,m=ve,B=ye,I=be,Z=ze,J=Ee,W=he;return n(),v("div",Se,[t(H,{type:"info",closable:!1,class:"mb-20"},{title:l(()=>[o("div",Be,[t(u,{size:"18"},{default:l(()=>[t(r(ne))]),_:1}),e[5]||(e[5]=o("span",null,"漏洞案例学习",-1))])]),default:l(()=>[e[6]||(e[6]=o("p",null,"这里展示已修复的真实漏洞案例，供安全研究人员和开发人员学习参考，提升安全意识",-1))]),_:1}),t(c,{shadow:"never",class:"search-card"},{default:l(()=>[t(Q,{model:i,inline:""},{default:l(()=>[t(L,{label:"关键词"},{default:l(()=>[t(K,{modelValue:i.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>i.keyword=a),placeholder:"漏洞标题",clearable:"",style:{width:"250px"},onClear:f},{prefix:l(()=>[t(u,null,{default:l(()=>[t(r(R))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"漏洞类型"},{default:l(()=>[t(S,{modelValue:i.vulnType,"onUpdate:modelValue":e[1]||(e[1]=a=>i.vulnType=a),placeholder:"请选择",clearable:"",style:{width:"150px"},onChange:f},{default:l(()=>[(n(!0),v(C,null,D($.value,a=>(n(),g(T,{key:a.dictValue,label:a.dictLabel,value:a.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"风险等级"},{default:l(()=>[t(S,{modelValue:i.riskLevel,"onUpdate:modelValue":e[2]||(e[2]=a=>i.riskLevel=a),placeholder:"请选择",clearable:"",style:{width:"120px"},onChange:f},{default:l(()=>[(n(!0),v(C,null,D(j.value,a=>(n(),g(T,{key:a.dictValue,label:a.dictLabel,value:a.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(L,null,{default:l(()=>[t(E,{type:"primary",onClick:f},{default:l(()=>[t(u,null,{default:l(()=>[t(r(R))]),_:1}),e[7]||(e[7]=y(" 搜索 ",-1))]),_:1}),t(E,{onClick:X},{default:l(()=>[t(u,null,{default:l(()=>[t(r(fe))]),_:1}),e[8]||(e[8]=y(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(B,{gutter:20,class:"stats-row"},{default:l(()=>[t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card"},{default:l(()=>[t(V,{title:"漏洞总数",value:k.value},{suffix:l(()=>[...e[9]||(e[9]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card stat-critical"},{default:l(()=>[t(V,{title:"严重漏洞",value:w.value.critical||0},{suffix:l(()=>[...e[10]||(e[10]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card stat-high"},{default:l(()=>[t(V,{title:"高危漏洞",value:w.value.high||0},{suffix:l(()=>[...e[11]||(e[11]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{span:6},{default:l(()=>[t(c,{shadow:"hover",class:"stat-card stat-medium"},{default:l(()=>[t(V,{title:"中危漏洞",value:w.value.medium||0},{suffix:l(()=>[...e[12]||(e[12]=[o("span",{class:"stat-suffix"},"个",-1)])]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),se((n(),g(B,{gutter:20},{default:l(()=>[(n(!0),v(C,null,D(z.value,a=>(n(),g(m,{key:a.id,xs:24,sm:12,md:8,lg:6},{default:l(()=>[t(c,{shadow:"hover",class:"vuln-card",onClick:Ae=>Y(a)},{default:l(()=>[o("div",{class:ke(["risk-badge",`risk-${a.riskLevel}`])},p(P(a.riskLevel)),3),o("div",Ie,[t(u,{size:48,color:q(a.riskLevel)},{default:l(()=>[t(r(we))]),_:1},8,["color"])]),o("h3",Fe,p(a.title),1),o("div",Ne,[t(I,{type:"info",size:"small"},{default:l(()=>[y(p(M(a.vulnType)),1)]),_:2},1024),t(I,{type:"success",size:"small",class:"ml-10"},{default:l(()=>[...e[13]||(e[13]=[y("已修复",-1)])]),_:1})]),o("div",Oe,p(A(a.description,80)),1),o("div",Re,[o("div",Ue,[t(u,null,{default:l(()=>[t(r(Le))]),_:1}),o("span",null,p(r(Te)(a.closeTime)),1)]),o("div",$e,[t(u,null,{default:l(()=>[t(r(Ve))]),_:1}),o("span",null,p(a.assetName),1)])]),o("div",je,[t(E,{type:"primary",size:"small",style:{width:"100%"}},{default:l(()=>[t(u,null,{default:l(()=>[t(r(xe))]),_:1}),e[14]||(e[14]=y(" 查看详情 ",-1))]),_:1})])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})),[[W,h.value]]),!h.value&&z.value.length===0?(n(),g(Z,{key:0,description:"暂无漏洞案例","image-size":200})):O("",!0),k.value>0?(n(),v("div",Me,[t(J,{"current-page":d.current,"onUpdate:currentPage":e[3]||(e[3]=a=>d.current=a),"page-size":d.size,"onUpdate:pageSize":e[4]||(e[4]=a=>d.size=a),total:k.value,"page-sizes":[12,24,48,96],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:b,onCurrentChange:b},null,8,["current-page","page-size","total"])])):O("",!0)])}}},lt=ee(Pe,[["__scopeId","data-v-684c2d9a"]]);export{lt as default};
