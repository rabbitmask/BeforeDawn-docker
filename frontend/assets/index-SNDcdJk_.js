import{_ as Z,i as ee,h as te,r as p,A as ae,c as y,o as d,d as l,K as le,w as a,b as r,aN as se,a3 as oe,I as g,D as ne,F as ie,aE as re,aF as ce,s as n,t as o,J as ue,aO as de,m as v,G as pe,H as _e,T as me,a5 as M,W as ve,X as fe,N as ye,aM as b,x as ge}from"./index-DT2C5K_G.js";/* empty css                   *//* empty css               *//* empty css                         *//* empty css                *//* empty css                             *//* empty css                *//* empty css               *//* empty css                   *//* empty css                       */import{a as be}from"./asset-jsgeP6m9.js";import{g as he}from"./vulnerability-DWH8dOd0.js";import{a as f}from"./index-CniuT_SX.js";const we={class:"page-container"},Te={class:"card-header"},ke={key:0,class:"vuln-list"},De=["onClick"],Le={class:"vuln-header"},Ee={class:"vuln-title"},Ve={class:"vuln-meta"},Ce={__name:"index",setup(Be){const N=ee(),h=te(),w=p(!1),s=p({}),_=p([]),D=p([]),L=p([]),E=p([]),T=p([]),S=e=>{const t=D.value.find(c=>c.dictValue===e);return t?t.dictLabel:e||"-"},x=e=>({web_application:"warning",mobile_app:"success",server_host:"info",network_device:"primary",domain:"",api:"primary",database:"danger",other:""})[e]||"",I=e=>{const t=L.value.find(c=>c.dictValue===e);return t?t.dictLabel:e||"-"},A=e=>({critical:"danger",high:"warning",medium:"",low:"info"})[e]||"",z=e=>e===1?"在用":"停用",F=e=>e===1?"success":"danger",R=async()=>{w.value=!0;try{const e=N.params.id;s.value=await be(e),await $(e)}catch(e){console.error("加载资产详情失败:",e),ge.error("加载资产详情失败")}finally{w.value=!1}},$=async e=>{try{const t=await he({current:1,size:10,assetId:e});_.value=t.records||[]}catch(t){console.error("加载关联漏洞失败:",t)}},H=e=>({critical:"danger",high:"warning",medium:"warning",low:"info",info:"info"})[e]||"info",U=e=>{const t=E.value.find(c=>c.dictValue===e);return t?t.dictLabel:e||"-"},G=e=>{const t=T.value.find(c=>c.dictValue===e);return t&&t.dictColor||"info"},J=e=>{const t=T.value.find(c=>c.dictValue===e);return t?t.dictLabel:e||"-"},K=e=>{h.push(`/vulnerability/detail/${e}`)},O=()=>{h.push(`/vulnerability/list?assetId=${s.value.id}`)},P=()=>{h.back()},W=async()=>{try{D.value=await b("asset_type"),L.value=await b("business_level"),E.value=await b("risk_level"),T.value=await b("vuln_status")}catch(e){console.error("加载字典数据失败:",e)}};return ae(()=>{W(),R()}),(e,t)=>{const c=se,i=ce,m=ue,V=de,X=re,k=ie,C=ne,j=me,B=fe,q=ve,Q=ye,Y=oe;return d(),y("div",we,[l(c,{onBack:P,class:"mb-20"},{content:a(()=>[...t[0]||(t[0]=[r("span",{class:"page-title"},"资产详情",-1)])]),_:1}),le((d(),g(Q,{gutter:20},{default:a(()=>[l(C,{span:16},{default:a(()=>[l(k,{shadow:"never",class:"mb-20"},{header:a(()=>[...t[1]||(t[1]=[r("div",{class:"card-header"},[r("span",null,"基本信息")],-1)])]),default:a(()=>[l(X,{column:2,border:""},{default:a(()=>[l(i,{label:"资产编号"},{default:a(()=>[n(o(s.value.assetCode),1)]),_:1}),l(i,{label:"资产名称"},{default:a(()=>[n(o(s.value.assetName),1)]),_:1}),l(i,{label:"资产类型"},{default:a(()=>[l(m,{type:x(s.value.assetType)},{default:a(()=>[n(o(S(s.value.assetType)),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"资产地址"},{default:a(()=>[l(V,{href:s.value.assetUrl,target:"_blank",type:"primary"},{default:a(()=>[n(o(s.value.assetUrl),1)]),_:1},8,["href"])]),_:1}),l(i,{label:"重要程度"},{default:a(()=>[l(m,{type:A(s.value.businessLevel)},{default:a(()=>[n(o(I(s.value.businessLevel)),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"资产状态"},{default:a(()=>[l(m,{type:F(s.value.status)},{default:a(()=>[n(o(z(s.value.status)),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"所属部门"},{default:a(()=>[n(o(s.value.departmentName||"-"),1)]),_:1}),l(i,{label:"负责人"},{default:a(()=>[n(o(s.value.ownerName||"-"),1)]),_:1}),l(i,{label:"技术栈",span:2},{default:a(()=>[n(o(s.value.techStack||"-"),1)]),_:1}),l(i,{label:"资产描述",span:2},{default:a(()=>[n(o(s.value.description||"-"),1)]),_:1}),l(i,{label:"创建时间"},{default:a(()=>[n(o(v(f)(s.value.createTime)),1)]),_:1}),l(i,{label:"更新时间"},{default:a(()=>[n(o(v(f)(s.value.updateTime)),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(C,{span:8},{default:a(()=>[l(k,{shadow:"never",class:"mb-20 vuln-card"},{header:a(()=>[r("div",Te,[r("span",null,"关联漏洞 ("+o(_.value.length)+")",1),_.value.length>0?(d(),g(V,{key:0,type:"primary",underline:!1,onClick:O},{default:a(()=>[...t[2]||(t[2]=[n(" 查看全部 ",-1)])]),_:1})):M("",!0)])]),default:a(()=>[_.value.length>0?(d(),y("div",ke,[(d(!0),y(pe,null,_e(_.value,u=>(d(),y("div",{key:u.id,class:"vuln-item",onClick:Me=>K(u.id)},[r("div",Le,[l(m,{type:H(u.severity),size:"small"},{default:a(()=>[n(o(U(u.severity)),1)]),_:2},1032,["type"]),l(m,{type:G(u.status),size:"small"},{default:a(()=>[n(o(J(u.status)),1)]),_:2},1032,["type"])]),r("div",Ee,o(u.title),1),r("div",Ve,[r("span",null,o(v(f)(u.createTime)),1)])],8,De))),128))])):(d(),g(j,{key:1,description:"暂无关联漏洞","image-size":80}))]),_:1}),l(k,{shadow:"never"},{header:a(()=>[...t[3]||(t[3]=[r("span",null,"操作记录",-1)])]),default:a(()=>[l(q,null,{default:a(()=>[l(B,{timestamp:"创建时间",hollow:!0},{default:a(()=>[n(o(v(f)(s.value.createTime)),1),t[4]||(t[4]=r("br",null,null,-1)),n(" 创建人："+o(s.value.createBy),1)]),_:1}),s.value.updateTime!==s.value.createTime?(d(),g(B,{key:0,timestamp:"最后更新",hollow:!0},{default:a(()=>[n(o(v(f)(s.value.updateTime)),1),t[5]||(t[5]=r("br",null,null,-1)),n(" 更新人："+o(s.value.updateBy),1)]),_:1})):M("",!0)]),_:1})]),_:1})]),_:1})]),_:1})),[[Y,w.value]])])}}},Ke=Z(Ce,[["__scopeId","data-v-f3d62a86"]]);export{Ke as default};
