import{_ as Y,i as Z,h as ee,u as te,aG as ae,r as k,y as le,z as se,aJ as oe,c as v,o as i,d as a,J as ne,w as e,b as o,aB as re,a2 as ie,H as p,C as ue,D as ce,aC as de,aD as me,s as u,t as n,m,aE as pe,I as _e,V as ve,F as w,G as T,W as fe,S as ge,a4 as ye,l as be,aK as he,q as ke,av as we,v as Te,M as Le,x as L}from"./index-P-kv1zA8.js";/* empty css                   *//* empty css               *//* empty css                         *//* empty css                *//* empty css                             *//* empty css                *//* empty css               *//* empty css                       */import{r as Ee}from"./style-WFyn0wIQ.js";import{b as Ce}from"./vulnerability-DkKcdRS0.js";import{g as De}from"./knowledge-D4KuY_Xz.js";import{f as E,a as Se}from"./format-BQFyjrq8.js";import{g as Ne}from"./file-SAOvPrPe.js";const xe={class:"page-container"},Ve={class:"card-header"},ze={style:{margin:"0"}},Be={class:"log-desc",style:{"white-space":"pre-wrap"}},Ie={class:"log-meta"},Re={key:0,class:"attachment-list"},Ae={class:"file-info"},Fe={class:"file-name"},Ue={class:"file-meta"},$e={class:"recommend-tip"},Me={__name:"index",setup(Ge){const z=Z(),C=ee(),B=te(),f=ae(),y=k(!1),l=k({}),g=k([]);le(()=>{var t;return l.value.assigneeId===((t=B.userInfo)==null?void 0:t.id)});const I=t=>f.getDictLabel("vuln_type",t),R=t=>({critical:"ä¸¥é‡",high:"é«˜å±",medium:"ä¸­å±",low:"ä½å±"})[t]||t,A=t=>({critical:"danger",high:"danger",medium:"warning",low:"info"})[t]||"",F=t=>f.getDictLabel("vuln_source",t),U=t=>f.getDictLabel("asset_type",t),$=t=>({assigned:"å¾…ä¿®å¤",fixed:"å¾…å¤æµ‹",closed:"å·²å®Œæˆ"})[t]||t,M=t=>({assigned:"warning",fixed:"primary",closed:"success"})[t]||"",G=t=>({submit:"æäº¤æ¼æ´",update:"æ›´æ–°æ¼æ´",fix:"æäº¤ä¿®å¤",retest:"å¤æµ‹æ¼æ´",delete:"åˆ é™¤æ¼æ´"})[t]||t,H=async()=>{y.value=!0;try{const t=z.params.id,s=await Ce(t);l.value=s,J()}catch(t){console.error("åŠ è½½æ¼æ´è¯¦æƒ…å¤±è´¥:",t),L.error("åŠ è½½æ¼æ´è¯¦æƒ…å¤±è´¥")}finally{y.value=!1}},J=async()=>{try{const t={};if(l.value.vulnType&&(t.vulnType=l.value.vulnType),l.value.assetType&&(t.assetType=l.value.assetType),l.value.techStack&&(t.techStack=l.value.techStack),Object.keys(t).length===0){console.log("ğŸ’¡ æç¤º: æ¼æ´ä¿¡æ¯ä¸è¶³ï¼Œæ— æ³•æ¨èæ–‡ç« ");return}const s=await De(t);g.value=s||[],console.log("ğŸ’¡ æ¨è:",g.value.length,"ç¯‡æ–‡ç« ")}catch(t){console.error("åŠ è½½æ¨èæ–‡ç« å¤±è´¥:",t)}},O=()=>{C.back()},P=t=>{C.push(`/asset/detail/${t}`)},j=t=>{try{const s=Ne(t.filePath),d=document.createElement("a");d.href=s,d.download=t.fileName||"é™„ä»¶",d.style.display="none",document.body.appendChild(d),d.click(),document.body.removeChild(d),L.success("å¼€å§‹ä¸‹è½½é™„ä»¶")}catch(s){console.error("ä¸‹è½½é™„ä»¶å¤±è´¥:",s),L.error("ä¸‹è½½é™„ä»¶å¤±è´¥")}};return se(async()=>{await f.loadDicts(["vuln_type","vuln_source","asset_type","risk_level","vuln_status"]),H()}),(t,s)=>{const d=re,b=_e,c=me,q=pe,D=de,_=ce,S=fe,N=ve,x=ge,V=ue,h=be,K=ke,Q=oe("router-link"),W=Le,X=ie;return i(),v("div",xe,[a(d,{onBack:O,class:"mb-20"},{content:e(()=>[...s[2]||(s[2]=[o("span",{class:"page-title"},"æ¼æ´è¯¦æƒ…",-1)])]),_:1}),ne((i(),p(W,{gutter:20},{default:e(()=>[a(V,{span:16},{default:e(()=>[a(_,{shadow:"never",class:"mb-20"},{header:e(()=>[o("div",Ve,[s[3]||(s[3]=o("span",null,"åŸºæœ¬ä¿¡æ¯",-1)),o("div",null,[a(b,{type:A(l.value.riskLevel),size:"large"},{default:e(()=>[u(n(R(l.value.riskLevel)),1)]),_:1},8,["type"]),a(b,{type:M(l.value.status),size:"large",class:"ml-10"},{default:e(()=>[u(n($(l.value.status)),1)]),_:1},8,["type"])])])]),default:e(()=>[a(D,{column:2,border:""},{default:e(()=>[a(c,{label:"æ¼æ´ç¼–å·"},{default:e(()=>[u(n(l.value.vulnCode),1)]),_:1}),a(c,{label:"æ¼æ´ç±»å‹"},{default:e(()=>[u(n(I(l.value.vulnType)),1)]),_:1}),a(c,{label:"æ¼æ´æ ‡é¢˜",span:2},{default:e(()=>[o("h3",ze,n(l.value.title),1)]),_:1}),a(c,{label:"æ¼æ´æè¿°",span:2},{default:e(()=>[a(m(Ee),{modelValue:l.value.description,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value.description=r),language:"zh-CN"},null,8,["modelValue"])]),_:1}),a(c,{label:"æ¼æ´æ¥æº"},{default:e(()=>[u(n(F(l.value.sourceType)),1)]),_:1}),a(c,{label:"æäº¤æ—¶é—´"},{default:e(()=>[u(n(m(E)(l.value.submitTime)),1)]),_:1}),a(c,{label:"å…³è”èµ„äº§",span:2},{default:e(()=>[a(q,{type:"primary",onClick:s[1]||(s[1]=r=>P(l.value.assetId))},{default:e(()=>[u(n(l.value.assetName),1)]),_:1}),a(b,{type:"info",size:"small",class:"ml-10"},{default:e(()=>[u(n(U(l.value.assetType)),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(_,{shadow:"never",class:"mb-20"},{header:e(()=>[...s[4]||(s[4]=[o("span",null,"äººå‘˜ä¿¡æ¯",-1)])]),default:e(()=>[a(D,{column:2,border:""},{default:e(()=>[a(c,{label:"æäº¤äºº"},{default:e(()=>[u(n(l.value.submitterName),1)]),_:1}),a(c,{label:"åˆ†é…ç»™"},{default:e(()=>[u(n(l.value.assigneeName||"-"),1)]),_:1}),a(c,{label:"æ‰€å±éƒ¨é—¨"},{default:e(()=>[u(n(l.value.departmentName||"-"),1)]),_:1}),a(c,{label:"åˆ†é…æ—¶é—´"},{default:e(()=>[u(n(m(E)(l.value.assignTime)),1)]),_:1})]),_:1})]),_:1}),a(_,{shadow:"never"},{header:e(()=>[...s[5]||(s[5]=[o("span",null,"æ“ä½œæ—¥å¿—",-1)])]),default:e(()=>[l.value.operationLogs&&l.value.operationLogs.length>0?(i(),p(N,{key:0},{default:e(()=>[(i(!0),v(w,null,T(l.value.operationLogs,r=>(i(),p(S,{key:r.id,timestamp:m(E)(r.operationTime),placement:"top"},{default:e(()=>[a(_,null,{default:e(()=>[o("h4",null,n(G(r.operationType)),1),o("p",Be,n(r.operationDesc),1),o("p",Ie,[o("span",null,"æ“ä½œäººï¼š"+n(r.operatorName),1)])]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(i(),p(x,{key:1,description:"æš‚æ— æ“ä½œæ—¥å¿—"}))]),_:1})]),_:1}),a(V,{span:8},{default:e(()=>[a(_,{shadow:"never",class:"mb-20"},{header:e(()=>[...s[6]||(s[6]=[o("span",null,"ç›¸å…³é™„ä»¶",-1)])]),default:e(()=>[l.value.attachments&&l.value.attachments.length>0?(i(),v("div",Re,[(i(!0),v(w,null,T(l.value.attachments,r=>(i(),v("div",{key:r.id,class:"attachment-item"},[a(h,{class:"file-icon"},{default:e(()=>[a(m(he))]),_:1}),o("div",Ae,[o("div",Fe,n(r.fileName),1),o("div",Ue,n(m(Se)(r.fileSize)),1)]),a(K,{link:"",type:"primary",onClick:He=>j(r)},{default:e(()=>[a(h,null,{default:e(()=>[a(m(we))]),_:1})]),_:1},8,["onClick"])]))),128))])):(i(),p(x,{key:1,description:"æš‚æ— é™„ä»¶","image-size":80}))]),_:1}),g.value.length>0?(i(),p(_,{key:0,shadow:"never"},{header:e(()=>[...s[7]||(s[7]=[o("div",{class:"card-header"},[o("span",null,"ğŸ’¡ ç›¸å…³ä¿®å¤æ–¹æ¡ˆæ¨è")],-1)])]),default:e(()=>[a(N,null,{default:e(()=>[(i(!0),v(w,null,T(g.value,r=>(i(),p(S,{key:r.id,timestamp:r.category,placement:"top"},{default:e(()=>[a(Q,{to:`/knowledge/article/${r.id}`,class:"article-link",target:"_blank"},{default:e(()=>[u(n(r.title),1)]),_:2},1032,["to"])]),_:2},1032,["timestamp"]))),128))]),_:1}),o("div",$e,[a(h,null,{default:e(()=>[a(m(Te))]),_:1}),s[8]||(s[8]=o("span",null,"SQLæ³¨å…¥éƒ½ä¿®äº†Néäº†ï¼Œè¿˜tmä¿®ä¸å¥½ï¼Ÿçœ‹çœ‹çŸ¥è¯†åº“ï¼",-1))])]),_:1})):ye("",!0)]),_:1})]),_:1})),[[X,y.value]])])}}},lt=Y(Me,[["__scopeId","data-v-78c33cde"]]);export{lt as default};
