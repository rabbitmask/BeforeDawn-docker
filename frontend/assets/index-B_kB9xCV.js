import{_ as K,a as O,u as Q,r as y,z as X,d as _,x as d,f as a,I as Y,w as e,e as i,aq as Z,a0 as ee,G as v,B as te,C as ae,ar as se,as as le,n as o,t as n,H as ne,at as oe,m as re,i as ie,j as ue,a3 as de,F as ce,D as pe,S as me,a2 as k,V as _e,W as ve,L as fe,v as ge}from"./index-nPQbSI0E.js";/* empty css                   *//* empty css               *//* empty css                         *//* empty css                *//* empty css                             *//* empty css                *//* empty css               *//* empty css                       */import{a as ye}from"./asset-OkoTRhFR.js";import{g as be}from"./vulnerability-cPp02ujM.js";const he={class:"page-container"},we={class:"card-header"},ke={class:"card-header"},Te={key:0,class:"vuln-list"},Ee=["onClick"],Ce={class:"vuln-header"},Ve={class:"vuln-title"},xe={class:"vuln-meta"},Be={__name:"index",setup(Ie){const T=O(),m=Q(),f=y(!1),l=y({}),c=y([]),E=t=>({domain:"域名",ip:"IP地址",application:"应用系统",database:"数据库",server:"服务器",other:"其他"})[t]||t,C=t=>({domain:"primary",ip:"success",application:"warning",database:"danger",server:"info",other:""})[t]||"",V=t=>({high:"高",medium:"中",low:"低"})[t]||t,x=t=>({high:"danger",medium:"warning",low:"success"})[t]||"",B=t=>({in_use:"在用",disabled:"停用",scrapped:"报废"})[t]||t,I=t=>({in_use:"success",disabled:"warning",scrapped:"danger"})[t]||"",L=async()=>{f.value=!0;try{const t=T.params.id;l.value=await ye(t),await D(t)}catch(t){console.error("加载资产详情失败:",t),ge.error("加载资产详情失败")}finally{f.value=!1}},D=async t=>{try{const s=await be({current:1,size:10,assetId:t});c.value=s.records||[]}catch(s){console.error("加载关联漏洞失败:",s)}},S=t=>({critical:"danger",high:"warning",medium:"primary",low:"info"})[t]||"info",N=t=>({critical:"严重",high:"高危",medium:"中危",low:"低危"})[t]||t,z=t=>({pending:"info",assigned:"warning",fixed:"primary",closed:"success",rejected:"danger"})[t]||"info",A=t=>({pending:"待分派",assigned:"待修复",fixed:"待复测",closed:"已关闭",rejected:"复测不通过"})[t]||t,$=t=>{m.push(`/vulnerability/detail/${t}`)},j=()=>{m.push(`/vulnerability/list?assetId=${l.value.id}`)},R=()=>{m.back()},F=()=>{m.push(`/asset/list?edit=${l.value.id}`)};return X(()=>{L()}),(t,s)=>{const H=Z,M=ie,P=re,r=le,p=ne,b=oe,U=se,g=ae,h=te,q=me,w=ve,G=_e,W=fe,J=ee;return d(),_("div",he,[a(H,{onBack:R,class:"mb-20"},{content:e(()=>[...s[0]||(s[0]=[i("span",{class:"page-title"},"资产详情",-1)])]),_:1}),Y((d(),v(W,{gutter:20},{default:e(()=>[a(h,{span:16},{default:e(()=>[a(g,{shadow:"never",class:"mb-20"},{header:e(()=>[i("div",we,[s[2]||(s[2]=i("span",null,"基本信息",-1)),a(P,{type:"primary",size:"small",onClick:F},{default:e(()=>[a(M,null,{default:e(()=>[a(ue(de))]),_:1}),s[1]||(s[1]=o(" 编辑 ",-1))]),_:1})])]),default:e(()=>[a(U,{column:2,border:""},{default:e(()=>[a(r,{label:"资产编号"},{default:e(()=>[o(n(l.value.assetCode),1)]),_:1}),a(r,{label:"资产名称"},{default:e(()=>[o(n(l.value.assetName),1)]),_:1}),a(r,{label:"资产类型"},{default:e(()=>[a(p,{type:C(l.value.assetType)},{default:e(()=>[o(n(E(l.value.assetType)),1)]),_:1},8,["type"])]),_:1}),a(r,{label:"资产地址"},{default:e(()=>[a(b,{href:l.value.assetUrl,target:"_blank",type:"primary"},{default:e(()=>[o(n(l.value.assetUrl),1)]),_:1},8,["href"])]),_:1}),a(r,{label:"重要程度"},{default:e(()=>[a(p,{type:x(l.value.importance)},{default:e(()=>[o(n(V(l.value.importance)),1)]),_:1},8,["type"])]),_:1}),a(r,{label:"资产状态"},{default:e(()=>[a(p,{type:I(l.value.status)},{default:e(()=>[o(n(B(l.value.status)),1)]),_:1},8,["type"])]),_:1}),a(r,{label:"所属部门"},{default:e(()=>[o(n(l.value.ownerDeptName||"-"),1)]),_:1}),a(r,{label:"负责人"},{default:e(()=>[o(n(l.value.ownerName||"-"),1)]),_:1}),a(r,{label:"技术栈",span:2},{default:e(()=>[o(n(l.value.techStack||"-"),1)]),_:1}),a(r,{label:"资产描述",span:2},{default:e(()=>[o(n(l.value.description||"-"),1)]),_:1}),a(r,{label:"创建时间"},{default:e(()=>[o(n(l.value.createTime),1)]),_:1}),a(r,{label:"更新时间"},{default:e(()=>[o(n(l.value.updateTime),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(h,{span:8},{default:e(()=>[a(g,{shadow:"never",class:"mb-20 vuln-card"},{header:e(()=>[i("div",ke,[i("span",null,"关联漏洞 ("+n(c.value.length)+")",1),c.value.length>0?(d(),v(b,{key:0,type:"primary",underline:!1,onClick:j},{default:e(()=>[...s[3]||(s[3]=[o(" 查看全部 ",-1)])]),_:1})):k("",!0)])]),default:e(()=>[c.value.length>0?(d(),_("div",Te,[(d(!0),_(ce,null,pe(c.value,u=>(d(),_("div",{key:u.id,class:"vuln-item",onClick:Le=>$(u.id)},[i("div",Ce,[a(p,{type:S(u.severity),size:"small"},{default:e(()=>[o(n(N(u.severity)),1)]),_:2},1032,["type"]),a(p,{type:z(u.status),size:"small"},{default:e(()=>[o(n(A(u.status)),1)]),_:2},1032,["type"])]),i("div",Ve,n(u.title),1),i("div",xe,[i("span",null,n(u.createTime),1)])],8,Ee))),128))])):(d(),v(q,{key:1,description:"暂无关联漏洞","image-size":80}))]),_:1}),a(g,{shadow:"never"},{header:e(()=>[...s[4]||(s[4]=[i("span",null,"操作记录",-1)])]),default:e(()=>[a(G,null,{default:e(()=>[a(w,{timestamp:"创建时间",hollow:!0},{default:e(()=>[o(n(l.value.createTime),1),s[5]||(s[5]=i("br",null,null,-1)),o(" 创建人："+n(l.value.createBy),1)]),_:1}),l.value.updateTime!==l.value.createTime?(d(),v(w,{key:0,timestamp:"最后更新",hollow:!0},{default:e(()=>[o(n(l.value.updateTime),1),s[6]||(s[6]=i("br",null,null,-1)),o(" 更新人："+n(l.value.updateBy),1)]),_:1})):k("",!0)]),_:1})]),_:1})]),_:1})]),_:1})),[[J,f.value]])])}}},Pe=K(Be,[["__scopeId","data-v-b25dd10d"]]);export{Pe as default};
