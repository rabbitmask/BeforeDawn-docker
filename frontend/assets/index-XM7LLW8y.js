import{_ as Z,g as ee,f as te,r as p,t as ae,c as y,o as d,e as l,G as le,w as a,b as r,aK as se,a0 as ne,C as g,y as oe,E as ie,aB as re,aC as ue,n as o,z as n,D as ce,aL as de,A as v,F as pe,B as _e,Q as me,a2 as S,T as ve,U as fe,K as ye,aJ as b,p as ge}from"./index-D-KiCPd7.js";/* empty css                   *//* empty css               *//* empty css                         *//* empty css                *//* empty css                             *//* empty css                *//* empty css               *//* empty css                   *//* empty css                       */import{a as be}from"./asset-Cd2orbhM.js";import{g as he}from"./vulnerability-B7wVUV0D.js";import{a as f}from"./index-DvArlCla.js";const we={class:"page-container"},Te={class:"card-header"},ke={key:0,class:"vuln-list"},Le=["onClick"],De={class:"vuln-header"},Ee={class:"vuln-title"},Ve={class:"vuln-meta"},Ce={__name:"index",setup(Be){const M=ee(),h=te(),w=p(!1),s=p({}),_=p([]),L=p([]),D=p([]),E=p([]),T=p([]),x=e=>{const t=L.value.find(u=>u.dictValue===e);return t?t.dictLabel:e||"-"},I=e=>({web_application:"warning",domain:"",api:"primary",ip:"info",database:"danger",other:""})[e]||"",N=e=>{const t=D.value.find(u=>u.dictValue===e);return t?t.dictLabel:e||"-"},A=e=>({critical:"danger",high:"warning",medium:"",low:"info"})[e]||"",z=e=>e===1?"在用":"停用",R=e=>e===1?"success":"danger",U=async()=>{w.value=!0;try{const e=M.params.id;s.value=await be(e),await $(e)}catch(e){console.error("加载资产详情失败:",e),ge.error("加载资产详情失败")}finally{w.value=!1}},$=async e=>{try{const t=await he({current:1,size:10,assetId:e});_.value=t.records||[]}catch(t){console.error("加载关联漏洞失败:",t)}},F=e=>({critical:"danger",high:"warning",medium:"warning",low:"info",info:"info"})[e]||"info",K=e=>{const t=E.value.find(u=>u.dictValue===e);return t?t.dictLabel:e||"-"},G=e=>{const t=T.value.find(u=>u.dictValue===e);return t&&t.dictColor||"info"},H=e=>{const t=T.value.find(u=>u.dictValue===e);return t?t.dictLabel:e||"-"},J=e=>{h.push(`/vulnerability/detail/${e}`)},P=()=>{h.push(`/vulnerability/list?assetId=${s.value.id}`)},Q=()=>{h.back()},j=async()=>{try{L.value=await b("asset_type"),D.value=await b("business_level"),E.value=await b("risk_level"),T.value=await b("vuln_status")}catch(e){console.error("加载字典数据失败:",e)}};return ae(()=>{j(),U()}),(e,t)=>{const u=se,i=ue,m=ce,V=de,q=re,k=ie,C=oe,O=me,B=fe,W=ve,X=ye,Y=ne;return d(),y("div",we,[l(u,{onBack:Q,class:"mb-20"},{content:a(()=>[...t[0]||(t[0]=[r("span",{class:"page-title"},"资产详情",-1)])]),_:1}),le((d(),g(X,{gutter:20},{default:a(()=>[l(C,{span:16},{default:a(()=>[l(k,{shadow:"never",class:"mb-20"},{header:a(()=>[...t[1]||(t[1]=[r("div",{class:"card-header"},[r("span",null,"基本信息")],-1)])]),default:a(()=>[l(q,{column:2,border:""},{default:a(()=>[l(i,{label:"资产编号"},{default:a(()=>[o(n(s.value.assetCode),1)]),_:1}),l(i,{label:"资产名称"},{default:a(()=>[o(n(s.value.assetName),1)]),_:1}),l(i,{label:"资产类型"},{default:a(()=>[l(m,{type:I(s.value.assetType)},{default:a(()=>[o(n(x(s.value.assetType)),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"资产地址"},{default:a(()=>[l(V,{href:s.value.assetUrl,target:"_blank",type:"primary"},{default:a(()=>[o(n(s.value.assetUrl),1)]),_:1},8,["href"])]),_:1}),l(i,{label:"重要程度"},{default:a(()=>[l(m,{type:A(s.value.businessLevel)},{default:a(()=>[o(n(N(s.value.businessLevel)),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"资产状态"},{default:a(()=>[l(m,{type:R(s.value.status)},{default:a(()=>[o(n(z(s.value.status)),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"所属部门"},{default:a(()=>[o(n(s.value.departmentName||"-"),1)]),_:1}),l(i,{label:"负责人"},{default:a(()=>[o(n(s.value.ownerName||"-"),1)]),_:1}),l(i,{label:"技术栈",span:2},{default:a(()=>[o(n(s.value.techStack||"-"),1)]),_:1}),l(i,{label:"资产描述",span:2},{default:a(()=>[o(n(s.value.description||"-"),1)]),_:1}),l(i,{label:"创建时间"},{default:a(()=>[o(n(v(f)(s.value.createTime)),1)]),_:1}),l(i,{label:"更新时间"},{default:a(()=>[o(n(v(f)(s.value.updateTime)),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(C,{span:8},{default:a(()=>[l(k,{shadow:"never",class:"mb-20 vuln-card"},{header:a(()=>[r("div",Te,[r("span",null,"关联漏洞 ("+n(_.value.length)+")",1),_.value.length>0?(d(),g(V,{key:0,type:"primary",underline:!1,onClick:P},{default:a(()=>[...t[2]||(t[2]=[o(" 查看全部 ",-1)])]),_:1})):S("",!0)])]),default:a(()=>[_.value.length>0?(d(),y("div",ke,[(d(!0),y(pe,null,_e(_.value,c=>(d(),y("div",{key:c.id,class:"vuln-item",onClick:Se=>J(c.id)},[r("div",De,[l(m,{type:F(c.severity),size:"small"},{default:a(()=>[o(n(K(c.severity)),1)]),_:2},1032,["type"]),l(m,{type:G(c.status),size:"small"},{default:a(()=>[o(n(H(c.status)),1)]),_:2},1032,["type"])]),r("div",Ee,n(c.title),1),r("div",Ve,[r("span",null,n(v(f)(c.createTime)),1)])],8,Le))),128))])):(d(),g(O,{key:1,description:"暂无关联漏洞","image-size":80}))]),_:1}),l(k,{shadow:"never"},{header:a(()=>[...t[3]||(t[3]=[r("span",null,"操作记录",-1)])]),default:a(()=>[l(W,null,{default:a(()=>[l(B,{timestamp:"创建时间",hollow:!0},{default:a(()=>[o(n(v(f)(s.value.createTime)),1),t[4]||(t[4]=r("br",null,null,-1)),o(" 创建人："+n(s.value.createBy),1)]),_:1}),s.value.updateTime!==s.value.createTime?(d(),g(B,{key:0,timestamp:"最后更新",hollow:!0},{default:a(()=>[o(n(v(f)(s.value.updateTime)),1),t[5]||(t[5]=r("br",null,null,-1)),o(" 更新人："+n(s.value.updateBy),1)]),_:1})):S("",!0)]),_:1})]),_:1})]),_:1})]),_:1})),[[Y,w.value]])])}}},Je=Z(Ce,[["__scopeId","data-v-f84f8824"]]);export{Je as default};
