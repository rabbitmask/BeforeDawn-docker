import{_ as ee,h as te,u as se,y as oe,r as D,z as V,a as A,A as le,B as ae,C as ne,c as v,o as u,d as s,w as o,D as ie,F as re,b as e,t as r,m as d,G as L,H as P,I as g,J as ce,s as p,K as de,q as ue,l as _e,L as me,M as fe,N as ve,O as M,P as $,Q as K,R as ge,S as pe,T as he,U as Ce,V as be,W as ke,X as ye,x as we,Y as C,Z as b}from"./index-IfYXXDZ7.js";/* empty css                         *//* empty css                    *//* empty css               *//* empty css                *//* empty css               */import{g as Se}from"./statistics-Bt1zDtyX.js";import{f as xe}from"./index-DqNpZBK2.js";import{i as Ee}from"./index-Bb6yjXMn.js";const Ne={class:"dashboard-container"},ze={class:"welcome-content"},De={class:"welcome-left"},Le={class:"user-tags"},Pe={class:"welcome-right"},Re={class:"stat-icon",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}},Ie={class:"stat-content"},Te={class:"stat-value"},Be={class:"stat-icon",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"}},Oe={class:"stat-content"},Ve={class:"stat-value"},Ae={class:"stat-icon",style:{background:"linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)"}},Me={class:"stat-content"},$e={class:"stat-value"},Ke={class:"stat-icon",style:{background:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"}},Ue={class:"stat-content"},We={class:"stat-value"},qe={class:"card-header"},Fe={class:"risk-chart-container"},He={class:"card-header"},Je={class:"fix-progress"},Ge={class:"progress-circle"},Qe={class:"percentage-value"},Xe={class:"progress-stats"},Ye={class:"progress-item total"},Ze={class:"item-icon"},je={class:"item-content"},et={class:"value"},tt={class:"progress-item success"},st={class:"item-icon"},ot={class:"item-content"},lt={class:"value"},at={class:"progress-item danger"},nt={class:"item-icon"},it={class:"item-content"},rt={class:"value"},ct={class:"card-header"},dt={class:"todo-list"},ut={key:1,class:"todo-items"},_t=["onClick"],mt={class:"todo-left"},ft={class:"todo-title"},vt={class:"todo-right"},gt={class:"todo-time"},pt={class:"activity-list"},ht=["onClick"],Ct={class:"activity-action"},bt={class:"activity-target"},kt={__name:"index",setup(yt){const h=te(),k=se(),R=oe(),U=t=>R.getDictLabel("risk_level",t),y=D(null);let c=null;const W=V(()=>{const t=new Date().getHours();return t<6?"ÂáåÊô®Â•Ω":t<9?"Êó©‰∏äÂ•Ω":t<12?"‰∏äÂçàÂ•Ω":t<14?"‰∏≠ÂçàÂ•Ω":t<18?"‰∏ãÂçàÂ•Ω":t<22?"Êôö‰∏äÂ•Ω":"Â§úÊ∑±‰∫Ü"}),a=A({assetCount:0,vulnCount:0,fixedCount:0,articleCount:0}),i=A({critical:0,high:0,medium:0,low:0,info:0,criticalPercent:0,highPercent:0,mediumPercent:0,lowPercent:0,infoPercent:0}),q=()=>{if(console.log("üî• [ÂõæË°®] ÂºÄÂßãÂàùÂßãÂåñÈ•ºÁä∂Âõæ"),console.log("üî• [ÂõæË°®] riskChartRef.value:",y.value),!y.value){console.error("‚ùå [ÂõæË°®] riskChartRef.value‰∏∫Á©∫ÔºåÊó†Ê≥ïÂàùÂßãÂåñ");return}c&&(c.dispose(),c=null),c=Ee(y.value),console.log("‚úÖ [ÂõæË°®] EChartsÂÆû‰æãÂàõÂª∫ÊàêÂäü:",c);const t={tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",right:"10%",top:"center"},series:[{name:"ÊºèÊ¥ûÈ£éÈô©",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:"{b}: {c}"},emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold"}},data:[]}]};c.setOption(t),console.log("‚úÖ [ÂõæË°®] ÂàùÂßãÈÖçÁΩÆÂ∑≤ËÆæÁΩÆ"),window.addEventListener("resize",()=>{c==null||c.resize()})},F=()=>{if(console.log("üî• [ÂõæË°®] ÂºÄÂßãÊõ¥Êñ∞Êï∞ÊçÆ"),console.log("üî• [ÂõæË°®] riskChartInstance:",c),console.log("üî• [ÂõæË°®] riskStats:",JSON.stringify(i)),!c){console.error("‚ùå [ÂõæË°®] riskChartInstance‰∏∫Á©∫ÔºåÊó†Ê≥ïÊõ¥Êñ∞");return}const t=[{name:b.critical,value:i.critical,itemStyle:{color:C.critical}},{name:b.high,value:i.high,itemStyle:{color:C.high}},{name:b.medium,value:i.medium,itemStyle:{color:C.medium}},{name:b.low,value:i.low,itemStyle:{color:C.low}},{name:b.info,value:i.info,itemStyle:{color:C.info}}].filter(l=>l.value>0);console.log("üî• [ÂõæË°®] chartData:",t),c.setOption({series:[{data:t}]}),console.log("‚úÖ [ÂõæË°®] Êï∞ÊçÆÊõ¥Êñ∞ÂÆåÊàê")},I=V(()=>a.vulnCount===0?0:Math.round(a.fixedCount/a.vulnCount*100)),w=D([]),z=D([]);async function H(){try{console.log("ÂºÄÂßãÂä†ËΩΩDashboardÊï∞ÊçÆ...");const t=await Se();console.log("Dashboard APIËøîÂõû:",t),t?(console.log("ÂéüÂßãÊï∞ÊçÆ:",{assetCount:t.assetCount,vulnCount:t.vulnCount,fixedCount:t.fixedCount,articleCount:t.articleCount}),a.assetCount=Number(t.assetCount)||0,a.vulnCount=Number(t.vulnCount)||0,a.fixedCount=Number(t.fixedCount)||0,a.articleCount=Number(t.articleCount)||0,console.log("ËΩ¨Êç¢ÂêéÁöÑstats:",{assetCount:a.assetCount,vulnCount:a.vulnCount,fixedCount:a.fixedCount,articleCount:a.articleCount}),t.riskStats&&(i.critical=Number(t.riskStats.critical)||0,i.high=Number(t.riskStats.high)||0,i.medium=Number(t.riskStats.medium)||0,i.low=Number(t.riskStats.low)||0,i.info=Number(t.riskStats.info)||0,i.criticalPercent=Number(t.riskStats.criticalPercent)||0,i.highPercent=Number(t.riskStats.highPercent)||0,i.mediumPercent=Number(t.riskStats.mediumPercent)||0,i.lowPercent=Number(t.riskStats.lowPercent)||0,i.infoPercent=Number(t.riskStats.infoPercent)||0,F(),console.log("È£éÈô©ÁªüËÆ°:",i)),await R.loadDict("risk_level"),w.value=t.todoList||[],z.value=t.activityList||[],console.log("DashboardÊï∞ÊçÆÂä†ËΩΩÊàêÂäü")):console.warn("DashboardËøîÂõûÊï∞ÊçÆÊ†ºÂºè‰∏çÊ≠£Á°Æ:",t)}catch(t){console.error("Âä†ËΩΩDashboardÊï∞ÊçÆÂ§±Ë¥•:",t),we.error("Âä†ËΩΩÊï∞ÊçÆÂ§±Ë¥•")}}const T=t=>{h.push(t)},J=()=>{h.push("/vulnerability/mytodo")},G=t=>{t.type==="vuln_case"?h.push("/knowledge/case"):t.type==="article"?h.push("/knowledge/article"):h.push("/knowledge")};return le(()=>{var t;console.log("È¶ñÈ°µÂä†ËΩΩÂÆåÊàêÔºåÁî®Êà∑:",(t=k.userInfo)==null?void 0:t.username),setTimeout(()=>{console.log("‚è∞ [Êó∂Â∫è] ÂºÄÂßãÂàùÂßãÂåñÂõæË°®"),q(),console.log("‚è∞ [Êó∂Â∫è] ÂõæË°®ÂàùÂßãÂåñÂÆåÊàêÔºåÂºÄÂßãÂä†ËΩΩÊï∞ÊçÆ"),H()},100)}),ae(()=>{c&&(c.dispose(),c=null)}),(t,l)=>{const S=ce,_=_e,B=ue,m=re,f=ie,x=ve,Q=pe,X=be,O=he,Y=ye,Z=ke,j=ne("permission");return u(),v("div",Ne,[s(x,{gutter:20},{default:o(()=>[s(f,{span:24},{default:o(()=>[s(m,{class:"welcome-card"},{default:o(()=>{var n,E;return[e("div",ze,[e("div",De,[e("h2",null,r(W.value)+"Ôºå"+r(((n=d(k).userInfo)==null?void 0:n.realName)||((E=d(k).userInfo)==null?void 0:E.username)||"ÊúãÂèã")+"ÔºÅ",1),e("div",Le,[(u(!0),v(L,null,P(d(k).roles,N=>(u(),g(S,{key:N,type:"primary",effect:"dark"},{default:o(()=>[p(r(N),1)]),_:2},1024))),128))]),l[2]||(l[2]=e("p",{class:"welcome-desc"},"‰ªäÂ§©‰πüË¶ÅÂä™ÂäõÊêûÂÆâÂÖ®ÂïäÔºÅ",-1))]),e("div",Pe,[de((u(),g(B,{type:"primary",size:"large",onClick:l[0]||(l[0]=N=>T("/vulnerability/submit"))},{default:o(()=>[s(_,null,{default:o(()=>[s(d(me))]),_:1}),l[3]||(l[3]=p(" Êèê‰∫§ÊºèÊ¥û ",-1))]),_:1})),[[j,"vuln:submit:add"]]),s(B,{type:"success",size:"large",onClick:l[1]||(l[1]=N=>T("/vulnerability/mytodo"))},{default:o(()=>[s(_,null,{default:o(()=>[s(d(fe))]),_:1}),l[4]||(l[4]=p(" ÊàëÁöÑÂæÖÂäû ",-1))]),_:1})])])]}),_:1})]),_:1})]),_:1}),s(x,{gutter:20,class:"mt-20"},{default:o(()=>[s(f,{xs:24,sm:12,md:6},{default:o(()=>[s(m,{class:"stat-card",shadow:"hover"},{default:o(()=>[e("div",Re,[s(_,{size:32},{default:o(()=>[s(d(M))]),_:1})]),e("div",Ie,[e("div",Te,r(a.assetCount),1),l[5]||(l[5]=e("div",{class:"stat-label"},"ËµÑ‰∫ßÊÄªÊï∞",-1))])]),_:1})]),_:1}),s(f,{xs:24,sm:12,md:6},{default:o(()=>[s(m,{class:"stat-card",shadow:"hover"},{default:o(()=>[e("div",Be,[s(_,{size:32},{default:o(()=>[s(d($))]),_:1})]),e("div",Oe,[e("div",Ve,r(a.vulnCount),1),l[6]||(l[6]=e("div",{class:"stat-label"},"ÊºèÊ¥ûÊÄªÊï∞",-1))])]),_:1})]),_:1}),s(f,{xs:24,sm:12,md:6},{default:o(()=>[s(m,{class:"stat-card",shadow:"hover"},{default:o(()=>[e("div",Ae,[s(_,{size:32},{default:o(()=>[s(d(K))]),_:1})]),e("div",Me,[e("div",$e,r(a.fixedCount),1),l[7]||(l[7]=e("div",{class:"stat-label"},"Â∑≤‰øÆÂ§ç",-1))])]),_:1})]),_:1}),s(f,{xs:24,sm:12,md:6},{default:o(()=>[s(m,{class:"stat-card",shadow:"hover"},{default:o(()=>[e("div",Ke,[s(_,{size:32},{default:o(()=>[s(d(ge))]),_:1})]),e("div",Ue,[e("div",We,r(a.articleCount),1),l[8]||(l[8]=e("div",{class:"stat-label"},"Áü•ËØÜÂ∫ìÊñáÁ´†",-1))])]),_:1})]),_:1})]),_:1}),s(x,{gutter:20,class:"mt-20"},{default:o(()=>[s(f,{xs:24,md:12},{default:o(()=>[s(m,null,{header:o(()=>[e("div",qe,[l[10]||(l[10]=e("span",null,"ÊºèÊ¥ûÈ£éÈô©",-1)),s(S,{type:"danger",size:"small"},{default:o(()=>[...l[9]||(l[9]=[p("ÂÆûÊó∂",-1)])]),_:1})])]),default:o(()=>[e("div",Fe,[e("div",{ref_key:"riskChartRef",ref:y,class:"risk-chart"},null,512)])]),_:1})]),_:1}),s(f,{xs:24,md:12},{default:o(()=>[s(m,null,{header:o(()=>[e("div",He,[l[11]||(l[11]=e("span",null,"‰øÆÂ§çËøõÂ∫¶",-1)),s(S,{type:"success",size:"small"},{default:o(()=>[p(r(I.value)+"%",1)]),_:1})])]),default:o(()=>[e("div",Je,[e("div",Ge,[s(Q,{type:"circle",percentage:I.value,width:180,"stroke-width":14},{default:o(({percentage:n})=>[e("span",Qe,r(n)+"%",1),l[12]||(l[12]=e("span",{class:"percentage-label"},"‰øÆÂ§çÁéá",-1))]),_:1},8,["percentage"])]),e("div",Xe,[e("div",Ye,[e("div",Ze,[s(_,{size:24},{default:o(()=>[s(d(M))]),_:1})]),e("div",je,[l[13]||(l[13]=e("span",{class:"label"},"ÊÄªËÆ°ÊºèÊ¥û",-1)),e("span",et,r(a.vulnCount),1)])]),e("div",tt,[e("div",st,[s(_,{size:24},{default:o(()=>[s(d(K))]),_:1})]),e("div",ot,[l[14]||(l[14]=e("span",{class:"label"},"Â∑≤‰øÆÂ§ç",-1)),e("span",lt,r(a.fixedCount),1)])]),e("div",at,[e("div",nt,[s(_,{size:24},{default:o(()=>[s(d($))]),_:1})]),e("div",it,[l[15]||(l[15]=e("span",{class:"label"},"ÂæÖ‰øÆÂ§ç",-1)),e("span",rt,r(a.vulnCount-a.fixedCount),1)])])])])]),_:1})]),_:1})]),_:1}),s(x,{gutter:20,class:"mt-20"},{default:o(()=>[s(f,{xs:24,md:12},{default:o(()=>[s(m,null,{header:o(()=>[e("div",ct,[l[16]||(l[16]=e("span",null,"ÊàëÁöÑÂæÖÂäû",-1)),s(X,{value:w.value.length,type:"danger"},null,8,["value"])])]),default:o(()=>[e("div",dt,[w.value.length===0?(u(),g(O,{key:0,description:"ÊöÇÊó†ÂæÖÂäû‰∫ãÈ°π","image-size":100})):(u(),v("div",ut,[(u(!0),v(L,null,P(w.value,n=>(u(),v("div",{key:n.id,class:"todo-item",onClick:E=>J(n)},[e("div",mt,[s(S,{type:n.levelType,size:"small"},{default:o(()=>[p(r(U(n.level)),1)]),_:2},1032,["type"]),e("span",ft,r(n.title),1)]),e("div",vt,[e("span",gt,r(n.time),1),s(_,null,{default:o(()=>[s(d(Ce))]),_:1})])],8,_t))),128))]))])]),_:1})]),_:1}),s(f,{xs:24,md:12},{default:o(()=>[s(m,null,{header:o(()=>[...l[17]||(l[17]=[e("div",{class:"card-header"},[e("span",null,"ÊúÄÊñ∞Âä®ÊÄÅ")],-1)])]),default:o(()=>[e("div",pt,[z.value.length===0?(u(),g(O,{key:0,description:"ÊöÇÊó†ÊúÄÊñ∞Âä®ÊÄÅ","image-size":100})):(u(),g(Z,{key:1},{default:o(()=>[(u(!0),v(L,null,P(z.value,n=>(u(),g(Y,{key:n.id,timestamp:d(xe)(n.time),color:n.color},{default:o(()=>[e("div",{class:"activity-content",onClick:E=>G(n)},[e("span",Ct,"„Äê"+r(n.action)+"„Äë",1),e("span",bt,r(n.target),1)],8,ht)]),_:2},1032,["timestamp","color"]))),128))]),_:1}))])]),_:1})]),_:1})]),_:1})])}}},Rt=ee(kt,[["__scopeId","data-v-3747981c"]]);export{Rt as default};
