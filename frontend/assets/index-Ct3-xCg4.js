import{_ as j,h as Z,u as ee,r as P,y as O,a as V,z as te,A as se,B as oe,c as v,o as u,d as t,w as o,C as ae,D as le,b as e,t as r,m as c,F as D,G as L,H as p,I as ne,s as g,J as ie,q as re,l as de,K as ce,L as ue,M as _e,N as A,O as M,P as $,Q as me,R as fe,S as ve,T as pe,U as ge,V as he,W as Ce,x as be,X as C,Y as b}from"./index-P-kv1zA8.js";/* empty css                         *//* empty css                    *//* empty css               *//* empty css                *//* empty css               */import{g as ke}from"./statistics-BZtVXzCz.js";import{f as ye}from"./index-CkDaei1-.js";import{i as we}from"./index-Bb6yjXMn.js";const xe={class:"dashboard-container"},Se={class:"welcome-content"},Ee={class:"welcome-left"},Ne={class:"user-tags"},ze={class:"welcome-right"},Pe={class:"stat-icon",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}},De={class:"stat-content"},Le={class:"stat-value"},Re={class:"stat-icon",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"}},Ie={class:"stat-content"},Te={class:"stat-value"},Be={class:"stat-icon",style:{background:"linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)"}},Oe={class:"stat-content"},Ve={class:"stat-value"},Ae={class:"stat-icon",style:{background:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"}},Me={class:"stat-content"},$e={class:"stat-value"},Ke={class:"card-header"},Ue={class:"risk-chart-container"},We={class:"card-header"},qe={class:"fix-progress"},Fe={class:"progress-circle"},He={class:"percentage-value"},Je={class:"progress-stats"},Ge={class:"progress-item total"},Qe={class:"item-icon"},Xe={class:"item-content"},Ye={class:"value"},je={class:"progress-item success"},Ze={class:"item-icon"},et={class:"item-content"},tt={class:"value"},st={class:"progress-item danger"},ot={class:"item-icon"},at={class:"item-content"},lt={class:"value"},nt={class:"card-header"},it={class:"todo-list"},rt={key:1,class:"todo-items"},dt=["onClick"],ct={class:"todo-left"},ut={class:"todo-title"},_t={class:"todo-right"},mt={class:"todo-time"},ft={class:"activity-list"},vt=["onClick"],pt={class:"activity-action"},gt={class:"activity-target"},ht={__name:"index",setup(Ct){const h=Z(),k=ee(),y=P(null);let d=null;const K=O(()=>{const s=new Date().getHours();return s<6?"å‡Œæ™¨å¥½":s<9?"æ—©ä¸Šå¥½":s<12?"ä¸Šåˆå¥½":s<14?"ä¸­åˆå¥½":s<18?"ä¸‹åˆå¥½":s<22?"æ™šä¸Šå¥½":"å¤œæ·±äº†"}),l=V({assetCount:0,vulnCount:0,fixedCount:0,articleCount:0}),i=V({critical:0,high:0,medium:0,low:0,info:0,criticalPercent:0,highPercent:0,mediumPercent:0,lowPercent:0,infoPercent:0}),U=()=>{if(console.log("ğŸ”¥ [å›¾è¡¨] å¼€å§‹åˆå§‹åŒ–é¥¼çŠ¶å›¾"),console.log("ğŸ”¥ [å›¾è¡¨] riskChartRef.value:",y.value),!y.value){console.error("âŒ [å›¾è¡¨] riskChartRef.valueä¸ºç©ºï¼Œæ— æ³•åˆå§‹åŒ–");return}d&&(d.dispose(),d=null),d=we(y.value),console.log("âœ… [å›¾è¡¨] EChartså®ä¾‹åˆ›å»ºæˆåŠŸ:",d);const s={tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",right:"10%",top:"center"},series:[{name:"æ¼æ´é£é™©",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:"{b}: {c}"},emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold"}},data:[]}]};d.setOption(s),console.log("âœ… [å›¾è¡¨] åˆå§‹é…ç½®å·²è®¾ç½®"),window.addEventListener("resize",()=>{d==null||d.resize()})},W=()=>{if(console.log("ğŸ”¥ [å›¾è¡¨] å¼€å§‹æ›´æ–°æ•°æ®"),console.log("ğŸ”¥ [å›¾è¡¨] riskChartInstance:",d),console.log("ğŸ”¥ [å›¾è¡¨] riskStats:",JSON.stringify(i)),!d){console.error("âŒ [å›¾è¡¨] riskChartInstanceä¸ºç©ºï¼Œæ— æ³•æ›´æ–°");return}const s=[{name:b.critical,value:i.critical,itemStyle:{color:C.critical}},{name:b.high,value:i.high,itemStyle:{color:C.high}},{name:b.medium,value:i.medium,itemStyle:{color:C.medium}},{name:b.low,value:i.low,itemStyle:{color:C.low}},{name:b.info,value:i.info,itemStyle:{color:C.info}}].filter(a=>a.value>0);console.log("ğŸ”¥ [å›¾è¡¨] chartData:",s),d.setOption({series:[{data:s}]}),console.log("âœ… [å›¾è¡¨] æ•°æ®æ›´æ–°å®Œæˆ")},R=O(()=>l.vulnCount===0?0:Math.round(l.fixedCount/l.vulnCount*100)),w=P([]),z=P([]);async function q(){try{console.log("å¼€å§‹åŠ è½½Dashboardæ•°æ®...");const s=await ke();console.log("Dashboard APIè¿”å›:",s),s?(console.log("åŸå§‹æ•°æ®:",{assetCount:s.assetCount,vulnCount:s.vulnCount,fixedCount:s.fixedCount,articleCount:s.articleCount}),l.assetCount=Number(s.assetCount)||0,l.vulnCount=Number(s.vulnCount)||0,l.fixedCount=Number(s.fixedCount)||0,l.articleCount=Number(s.articleCount)||0,console.log("è½¬æ¢åçš„stats:",{assetCount:l.assetCount,vulnCount:l.vulnCount,fixedCount:l.fixedCount,articleCount:l.articleCount}),s.riskStats&&(i.critical=Number(s.riskStats.critical)||0,i.high=Number(s.riskStats.high)||0,i.medium=Number(s.riskStats.medium)||0,i.low=Number(s.riskStats.low)||0,i.info=Number(s.riskStats.info)||0,i.criticalPercent=Number(s.riskStats.criticalPercent)||0,i.highPercent=Number(s.riskStats.highPercent)||0,i.mediumPercent=Number(s.riskStats.mediumPercent)||0,i.lowPercent=Number(s.riskStats.lowPercent)||0,i.infoPercent=Number(s.riskStats.infoPercent)||0,W(),console.log("é£é™©ç»Ÿè®¡:",i)),w.value=s.todoList||[],z.value=s.activityList||[],console.log("Dashboardæ•°æ®åŠ è½½æˆåŠŸ")):console.warn("Dashboardè¿”å›æ•°æ®æ ¼å¼ä¸æ­£ç¡®:",s)}catch(s){console.error("åŠ è½½Dashboardæ•°æ®å¤±è´¥:",s),be.error("åŠ è½½æ•°æ®å¤±è´¥")}}const I=s=>{h.push(s)},F=()=>{h.push("/vulnerability/mytodo")},H=s=>{s.type==="vuln_case"?h.push("/knowledge/case"):s.type==="article"?h.push("/knowledge/article"):h.push("/knowledge")};return te(()=>{var s;console.log("é¦–é¡µåŠ è½½å®Œæˆï¼Œç”¨æˆ·:",(s=k.userInfo)==null?void 0:s.username),setTimeout(()=>{console.log("â° [æ—¶åº] å¼€å§‹åˆå§‹åŒ–å›¾è¡¨"),U(),console.log("â° [æ—¶åº] å›¾è¡¨åˆå§‹åŒ–å®Œæˆï¼Œå¼€å§‹åŠ è½½æ•°æ®"),q()},100)}),se(()=>{d&&(d.dispose(),d=null)}),(s,a)=>{const x=ne,_=de,T=re,m=le,f=ae,S=_e,J=fe,G=ge,B=ve,Q=Ce,X=he,Y=oe("permission");return u(),v("div",xe,[t(S,{gutter:20},{default:o(()=>[t(f,{span:24},{default:o(()=>[t(m,{class:"welcome-card"},{default:o(()=>{var n,E;return[e("div",Se,[e("div",Ee,[e("h2",null,r(K.value)+"ï¼Œ"+r(((n=c(k).userInfo)==null?void 0:n.realName)||((E=c(k).userInfo)==null?void 0:E.username)||"æœ‹å‹")+"ï¼",1),e("div",Ne,[(u(!0),v(D,null,L(c(k).roles,N=>(u(),p(x,{key:N,type:"primary",effect:"dark"},{default:o(()=>[g(r(N),1)]),_:2},1024))),128))]),a[2]||(a[2]=e("p",{class:"welcome-desc"},"ä»Šå¤©ä¹Ÿè¦åŠªåŠ›æå®‰å…¨å•Šï¼",-1))]),e("div",ze,[ie((u(),p(T,{type:"primary",size:"large",onClick:a[0]||(a[0]=N=>I("/vulnerability/submit"))},{default:o(()=>[t(_,null,{default:o(()=>[t(c(ce))]),_:1}),a[3]||(a[3]=g(" æäº¤æ¼æ´ ",-1))]),_:1})),[[Y,"vuln:submit:add"]]),t(T,{type:"success",size:"large",onClick:a[1]||(a[1]=N=>I("/vulnerability/mytodo"))},{default:o(()=>[t(_,null,{default:o(()=>[t(c(ue))]),_:1}),a[4]||(a[4]=g(" æˆ‘çš„å¾…åŠ ",-1))]),_:1})])])]}),_:1})]),_:1})]),_:1}),t(S,{gutter:20,class:"mt-20"},{default:o(()=>[t(f,{xs:24,sm:12,md:6},{default:o(()=>[t(m,{class:"stat-card",shadow:"hover"},{default:o(()=>[e("div",Pe,[t(_,{size:32},{default:o(()=>[t(c(A))]),_:1})]),e("div",De,[e("div",Le,r(l.assetCount),1),a[5]||(a[5]=e("div",{class:"stat-label"},"èµ„äº§æ€»æ•°",-1))])]),_:1})]),_:1}),t(f,{xs:24,sm:12,md:6},{default:o(()=>[t(m,{class:"stat-card",shadow:"hover"},{default:o(()=>[e("div",Re,[t(_,{size:32},{default:o(()=>[t(c(M))]),_:1})]),e("div",Ie,[e("div",Te,r(l.vulnCount),1),a[6]||(a[6]=e("div",{class:"stat-label"},"æ¼æ´æ€»æ•°",-1))])]),_:1})]),_:1}),t(f,{xs:24,sm:12,md:6},{default:o(()=>[t(m,{class:"stat-card",shadow:"hover"},{default:o(()=>[e("div",Be,[t(_,{size:32},{default:o(()=>[t(c($))]),_:1})]),e("div",Oe,[e("div",Ve,r(l.fixedCount),1),a[7]||(a[7]=e("div",{class:"stat-label"},"å·²ä¿®å¤",-1))])]),_:1})]),_:1}),t(f,{xs:24,sm:12,md:6},{default:o(()=>[t(m,{class:"stat-card",shadow:"hover"},{default:o(()=>[e("div",Ae,[t(_,{size:32},{default:o(()=>[t(c(me))]),_:1})]),e("div",Me,[e("div",$e,r(l.articleCount),1),a[8]||(a[8]=e("div",{class:"stat-label"},"çŸ¥è¯†åº“æ–‡ç« ",-1))])]),_:1})]),_:1})]),_:1}),t(S,{gutter:20,class:"mt-20"},{default:o(()=>[t(f,{xs:24,md:12},{default:o(()=>[t(m,null,{header:o(()=>[e("div",Ke,[a[10]||(a[10]=e("span",null,"æ¼æ´é£é™©",-1)),t(x,{type:"danger",size:"small"},{default:o(()=>[...a[9]||(a[9]=[g("å®æ—¶",-1)])]),_:1})])]),default:o(()=>[e("div",Ue,[e("div",{ref_key:"riskChartRef",ref:y,class:"risk-chart"},null,512)])]),_:1})]),_:1}),t(f,{xs:24,md:12},{default:o(()=>[t(m,null,{header:o(()=>[e("div",We,[a[11]||(a[11]=e("span",null,"ä¿®å¤è¿›åº¦",-1)),t(x,{type:"success",size:"small"},{default:o(()=>[g(r(R.value)+"%",1)]),_:1})])]),default:o(()=>[e("div",qe,[e("div",Fe,[t(J,{type:"circle",percentage:R.value,width:180,"stroke-width":14},{default:o(({percentage:n})=>[e("span",He,r(n)+"%",1),a[12]||(a[12]=e("span",{class:"percentage-label"},"ä¿®å¤ç‡",-1))]),_:1},8,["percentage"])]),e("div",Je,[e("div",Ge,[e("div",Qe,[t(_,{size:24},{default:o(()=>[t(c(A))]),_:1})]),e("div",Xe,[a[13]||(a[13]=e("span",{class:"label"},"æ€»è®¡æ¼æ´",-1)),e("span",Ye,r(l.vulnCount),1)])]),e("div",je,[e("div",Ze,[t(_,{size:24},{default:o(()=>[t(c($))]),_:1})]),e("div",et,[a[14]||(a[14]=e("span",{class:"label"},"å·²ä¿®å¤",-1)),e("span",tt,r(l.fixedCount),1)])]),e("div",st,[e("div",ot,[t(_,{size:24},{default:o(()=>[t(c(M))]),_:1})]),e("div",at,[a[15]||(a[15]=e("span",{class:"label"},"å¾…ä¿®å¤",-1)),e("span",lt,r(l.vulnCount-l.fixedCount),1)])])])])]),_:1})]),_:1})]),_:1}),t(S,{gutter:20,class:"mt-20"},{default:o(()=>[t(f,{xs:24,md:12},{default:o(()=>[t(m,null,{header:o(()=>[e("div",nt,[a[16]||(a[16]=e("span",null,"æˆ‘çš„å¾…åŠ",-1)),t(G,{value:w.value.length,type:"danger"},null,8,["value"])])]),default:o(()=>[e("div",it,[w.value.length===0?(u(),p(B,{key:0,description:"æš‚æ— å¾…åŠäº‹é¡¹","image-size":100})):(u(),v("div",rt,[(u(!0),v(D,null,L(w.value,n=>(u(),v("div",{key:n.id,class:"todo-item",onClick:E=>F(n)},[e("div",ct,[t(x,{type:n.levelType,size:"small"},{default:o(()=>[g(r(n.level),1)]),_:2},1032,["type"]),e("span",ut,r(n.title),1)]),e("div",_t,[e("span",mt,r(n.time),1),t(_,null,{default:o(()=>[t(c(pe))]),_:1})])],8,dt))),128))]))])]),_:1})]),_:1}),t(f,{xs:24,md:12},{default:o(()=>[t(m,null,{header:o(()=>[...a[17]||(a[17]=[e("div",{class:"card-header"},[e("span",null,"æœ€æ–°åŠ¨æ€")],-1)])]),default:o(()=>[e("div",ft,[z.value.length===0?(u(),p(B,{key:0,description:"æš‚æ— æœ€æ–°åŠ¨æ€","image-size":100})):(u(),p(X,{key:1},{default:o(()=>[(u(!0),v(D,null,L(z.value,n=>(u(),p(Q,{key:n.id,timestamp:c(ye)(n.time),color:n.color},{default:o(()=>[e("div",{class:"activity-content",onClick:E=>H(n)},[e("span",pt,"ã€"+r(n.action)+"ã€‘",1),e("span",gt,r(n.target),1)],8,vt)]),_:2},1032,["timestamp","color"]))),128))]),_:1}))])]),_:1})]),_:1})]),_:1})])}}},Pt=j(ht,[["__scopeId","data-v-0fc03d60"]]);export{Pt as default};
