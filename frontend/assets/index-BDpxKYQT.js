import{_ as Z,i as ee,h as te,r as p,z as ae,c as y,o as d,d as l,J as le,w as a,b as r,aB as se,a2 as ne,H as g,C as oe,D as ie,aC as re,aD as ce,s as o,t as n,I as ue,aE as de,m as v,F as pe,G as _e,S as me,a4 as S,V as ve,W as fe,M as ye,az as b,x as ge}from"./index-P-kv1zA8.js";/* empty css                   *//* empty css               *//* empty css                         *//* empty css                *//* empty css                             *//* empty css                *//* empty css               *//* empty css                       */import{a as be}from"./asset-BQObA34q.js";import{g as he}from"./vulnerability-DkKcdRS0.js";import{a as f}from"./index-CkDaei1-.js";const we={class:"page-container"},ke={class:"card-header"},Te={key:0,class:"vuln-list"},De=["onClick"],Le={class:"vuln-header"},Ve={class:"vuln-title"},Ee={class:"vuln-meta"},Ce={__name:"index",setup(Be){const M=ee(),h=te(),w=p(!1),s=p({}),_=p([]),D=p([]),L=p([]),V=p([]),k=p([]),x=e=>{const t=D.value.find(c=>c.dictValue===e);return t?t.dictLabel:e||"-"},I=e=>({web_application:"warning",mobile_app:"success",server_host:"info",network_device:"primary",domain:"",api:"primary",database:"danger",other:""})[e]||"",N=e=>{const t=L.value.find(c=>c.dictValue===e);return t?t.dictLabel:e||"-"},z=e=>({critical:"danger",high:"warning",medium:"",low:"info"})[e]||"",A=e=>e===1?"在用":"停用",R=e=>e===1?"success":"danger",$=async()=>{w.value=!0;try{const e=M.params.id;s.value=await be(e),await F(e)}catch(e){console.error("加载资产详情失败:",e),ge.error("加载资产详情失败")}finally{w.value=!1}},F=async e=>{try{const t=await he({current:1,size:10,assetId:e});_.value=t.records||[]}catch(t){console.error("加载关联漏洞失败:",t)}},H=e=>({critical:"danger",high:"warning",medium:"warning",low:"info",info:"info"})[e]||"info",U=e=>{const t=V.value.find(c=>c.dictValue===e);return t?t.dictLabel:e||"-"},G=e=>{const t=k.value.find(c=>c.dictValue===e);return t&&t.dictColor||"info"},J=e=>{const t=k.value.find(c=>c.dictValue===e);return t?t.dictLabel:e||"-"},P=e=>{h.push(`/vulnerability/detail/${e}`)},W=()=>{h.push(`/vulnerability/list?assetId=${s.value.id}`)},j=()=>{h.back()},q=async()=>{try{D.value=await b("asset_type"),L.value=await b("business_level"),V.value=await b("risk_level"),k.value=await b("vuln_status")}catch(e){console.error("加载字典数据失败:",e)}};return ae(()=>{q(),$()}),(e,t)=>{const c=se,i=ce,m=ue,E=de,K=re,T=ie,C=oe,O=me,B=fe,Q=ve,X=ye,Y=ne;return d(),y("div",we,[l(c,{onBack:j,class:"mb-20"},{content:a(()=>[...t[0]||(t[0]=[r("span",{class:"page-title"},"资产详情",-1)])]),_:1}),le((d(),g(X,{gutter:20},{default:a(()=>[l(C,{span:16},{default:a(()=>[l(T,{shadow:"never",class:"mb-20"},{header:a(()=>[...t[1]||(t[1]=[r("div",{class:"card-header"},[r("span",null,"基本信息")],-1)])]),default:a(()=>[l(K,{column:2,border:""},{default:a(()=>[l(i,{label:"资产编号"},{default:a(()=>[o(n(s.value.assetCode),1)]),_:1}),l(i,{label:"资产名称"},{default:a(()=>[o(n(s.value.assetName),1)]),_:1}),l(i,{label:"资产类型"},{default:a(()=>[l(m,{type:I(s.value.assetType)},{default:a(()=>[o(n(x(s.value.assetType)),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"资产地址"},{default:a(()=>[l(E,{href:s.value.assetUrl,target:"_blank",type:"primary"},{default:a(()=>[o(n(s.value.assetUrl),1)]),_:1},8,["href"])]),_:1}),l(i,{label:"重要程度"},{default:a(()=>[l(m,{type:z(s.value.businessLevel)},{default:a(()=>[o(n(N(s.value.businessLevel)),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"资产状态"},{default:a(()=>[l(m,{type:R(s.value.status)},{default:a(()=>[o(n(A(s.value.status)),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"所属部门"},{default:a(()=>[o(n(s.value.departmentName||"-"),1)]),_:1}),l(i,{label:"负责人"},{default:a(()=>[o(n(s.value.ownerName||"-"),1)]),_:1}),l(i,{label:"技术栈",span:2},{default:a(()=>[o(n(s.value.techStack||"-"),1)]),_:1}),l(i,{label:"资产描述",span:2},{default:a(()=>[o(n(s.value.description||"-"),1)]),_:1}),l(i,{label:"创建时间"},{default:a(()=>[o(n(v(f)(s.value.createTime)),1)]),_:1}),l(i,{label:"更新时间"},{default:a(()=>[o(n(v(f)(s.value.updateTime)),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(C,{span:8},{default:a(()=>[l(T,{shadow:"never",class:"mb-20 vuln-card"},{header:a(()=>[r("div",ke,[r("span",null,"关联漏洞 ("+n(_.value.length)+")",1),_.value.length>0?(d(),g(E,{key:0,type:"primary",underline:!1,onClick:W},{default:a(()=>[...t[2]||(t[2]=[o(" 查看全部 ",-1)])]),_:1})):S("",!0)])]),default:a(()=>[_.value.length>0?(d(),y("div",Te,[(d(!0),y(pe,null,_e(_.value,u=>(d(),y("div",{key:u.id,class:"vuln-item",onClick:Se=>P(u.id)},[r("div",Le,[l(m,{type:H(u.severity),size:"small"},{default:a(()=>[o(n(U(u.severity)),1)]),_:2},1032,["type"]),l(m,{type:G(u.status),size:"small"},{default:a(()=>[o(n(J(u.status)),1)]),_:2},1032,["type"])]),r("div",Ve,n(u.title),1),r("div",Ee,[r("span",null,n(v(f)(u.createTime)),1)])],8,De))),128))])):(d(),g(O,{key:1,description:"暂无关联漏洞","image-size":80}))]),_:1}),l(T,{shadow:"never"},{header:a(()=>[...t[3]||(t[3]=[r("span",null,"操作记录",-1)])]),default:a(()=>[l(Q,null,{default:a(()=>[l(B,{timestamp:"创建时间",hollow:!0},{default:a(()=>[o(n(v(f)(s.value.createTime)),1),t[4]||(t[4]=r("br",null,null,-1)),o(" 创建人："+n(s.value.createBy),1)]),_:1}),s.value.updateTime!==s.value.createTime?(d(),g(B,{key:0,timestamp:"最后更新",hollow:!0},{default:a(()=>[o(n(v(f)(s.value.updateTime)),1),t[5]||(t[5]=r("br",null,null,-1)),o(" 更新人："+n(s.value.updateBy),1)]),_:1})):S("",!0)]),_:1})]),_:1})]),_:1})]),_:1})),[[Y,w.value]])])}}},Je=Z(Ce,[["__scopeId","data-v-f3d62a86"]]);export{Je as default};
